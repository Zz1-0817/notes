\chapter{预备知识}

本章涉及的环均是带单位的交换环


%TODO: 和不可约的关系?

\section{Noetherian 环与 Noetherian 模}

\begin{proposition}
  \label{proposition-Noetherian-ring-iff-condition}
  给定一个环 \( A \), 下面条件等价
  \begin{enumerate}
    \item \( A \) 的每个理想都是有限生成的.
    \item \( A \) 的每个理想上升链 \( \mathfrak{a}_1 \subseteq \mathfrak{a}_2 \subseteq
      \cdots \) 都将终止, 也就是存在 \( m \) 使得
      \[
        \mathfrak{a}_m = \mathfrak{a}_{m + 1} = \cdots.
      \]
    \item \( A \) 的任何非空的理想集都存在一个极大元.
  \end{enumerate}
\end{proposition}
\begin{proof}
  (i) \( \implies \) (ii)
  如果 \( \mathfrak{a}_1 \subseteq \mathfrak{a}_2 \subseteq \cdots \)
  是一个上升链, 那么 \( \mathfrak{a} = \bigcup \mathfrak{a}_i \) 是一个理想.
  它由有限个生成元, 记为 \( a_1, \ldots, a_n \). 因此, 总有一个 \( m \) 使得所有
  \( a_i \in \mathfrak{a}_m \) 成立, 因此
  \[
    \mathfrak{a}_m = \mathfrak{a}_{m + 1} = \cdots = \mathfrak{a}.
  \]

  (ii) \( \implies \) (iii) 如果 \( \Sigma \) 没有极大元, 那么由
  \href{https://en.wikipedia.org/wiki/Axiom_of_choice}{选择公理},
  能找到一个无穷的上升链, 矛盾.

  (iii) \( \implies \) (i) 假设 \( \mathfrak{a} \) 是 \( A \) 的任意一个理想.
  考察所有包含于 \( \mathfrak{a} \) 的有限生成理想组成的集族 \( \Sigma \).
  由假设, \( \Sigma \) 有一个极大元 \( \mathfrak{m} \), 如果 \( \mathfrak{a}
  \neq \mathfrak{m} \), 那么存在 \( x \in \mathfrak{a} \) 但 \( x \notin
  \mathfrak{m} \), 进而 \( \mathfrak{m} \subsetneq \left( x,
  \mathfrak{m} \right) \) 与极大性矛盾. 因此 \( \mathfrak{a} = \mathfrak{m} \)
  有限生成.
\end{proof}

一个环 \( A \) 称为是 \emph{noetherian 的}, 如果其满足
\cref{proposition-Noetherian-ring-iff-condition} 中的等价条件. 譬如说,
主理想整环和域是 noetherian 的. noetherian 环的商自然是 noetherian 环.

\begin{proposition}
  \label{proposition-Noetherian-module-iff-condition}
  假设 \( A \) 是一个环. 那么下面条件对 \( A \)-模 \( M \) 是等价的
  \begin{enumerate}
    \item 每个 \( M \) 的子模是有限生成的.
    \item 每个 \( M \) 的子模上升链是终止的.
    \item 每个 \( M \) 的非空子模集族有极大元.
  \end{enumerate}
\end{proposition}

一个 \( A \)-模 \( M \) 是 \emph{noetherian} 的, 如果其满足
\cref{proposition-Noetherian-module-iff-condition} 中的等价条件.

\subsection{Noetherian 模的基本性质}

\begin{proposition}
  \label{proposition-exact-sequence-noetherian-module}
  假设 \( A \) 是一个环且
  \[
    0 \to M' \xrightarrow{\alpha} M \xrightarrow{\beta} M'' \to 0
  \]
  是一个 \( A \)-模正合列. 那么
  \begin{enumerate}
    \item 如果 \( N \subseteq P \) 是 \( M \) 的子模, 使得 \( \alpha(M') \cap N
      = \alpha(M') \cap P \) 且 \( \beta(N) = \beta(P) \), 那么 \( N = P \).
    \item 如果 \( M' \) 和 \( M'' \) 都是有限生成的, 那么 \( M \)
      亦是有限生成的.
    \item \( M \) 是 noetherian 的当且仅当 \( M' \) 和 \( M'' \) 都是 noetherian
      的.
  \end{enumerate}
  特别地, \( M_1 \oplus M_2 \) noetherian 当且仅当 \( M_1 \) 和 \( M_2 \) 都
  noetherian.
\end{proposition}
\begin{proof}
  (i) 假设 \( p \in P \). 那么由假设, 存在 \( n \in N \) 使得 \( \beta(n) =
  \beta(p) \), 所以 \( p - n = \operatorname{ker} p = \operatorname{im} \alpha
  \). 而 \( p - n \in P \), 又由条件 \( p - n \in N \). 因此 \( p = (p - n) + n
  \in N \).

  (ii) 假设 \( S' \) 为 \( M' \) 的有限生成元集,
  \( S'' \) 为 \( M \) 中的有限有限元素, 使得 \( \beta (S'') \) 为 \( M'' \)
  的有限生成元集.
  考察 \( \alpha(S') \cup S'' \) 生成的子模 \( N \), 令 \( P = M \), \( N \) 和
  \( P \) 满足 (1) 所说的, 因此它们相等.

  (iii) \( \implies \) 如果 \( M \) 是 noetherian 的, 那么 \( M' \) 中的子模链
  \( \mathfrak{a}_1 \subseteq \mathfrak{a}_2 \subseteq \cdots \) 通过单射 \(
  \alpha \) 映到 \( M \) 终止, 其本身终止; \( M'' \) 中的子模链 \(
  \mathfrak{a}_1 \subseteq \mathfrak{a}_2 \subseteq \cdots \) 的逆链 \(
  \beta^{-1}(\mathfrak{a}_1) \subseteq \beta^{-1}(\mathfrak{a}_2) \subseteq
  \cdots \) 亦是 \( M \) 的子模链, 遂终止. \( \impliedby \) 考虑 \( M \)
  的子模链 \( \mathfrak{a}_1 \subseteq \mathfrak{a}_2 \subseteq \cdots \) 其通过
  \( \beta \) 映到终止的 \( M'' \) 子模链. 而将 \( \alpha(M') \cap
  \mathfrak{a}_1 \subseteq \alpha(M') \cap \mathfrak{a}_2 \subseteq \cdots \)
  视为 \( M' \) 中的子链(或取逆链), 知道其终止. 再次利用(i),
  我们就能得到我们想要的.
\end{proof}

\begin{proposition}
  \label{proposition-finite-generated-module-over-noetherian-ring}
  每个 noetherian 环 \( A \) 上的有限生成模 \( M \) 是 noetherian 的.
\end{proposition}
\begin{proof}
  我们对 \( M \) 的极小生成元个数 \( n \) 进行归纳. 当 \( n = 1 \) 时, \( M
  \simeq A / \mathfrak{a} \) 其中 \( \mathfrak{a} \) 为 \( A \) 的理想,
  我们前面说过这是 noetherian 的. 当 \( n > 1 \) 时, \( M = \left\langle a_1,
  \ldots, a_n \right\rangle \) 有一个子模 \( N = \left\langle a_1, \ldots, a_{n
  - 1} \right\rangle \). 考察 \( 0 \to N \to M \to M / N \to 0 \) 并利用
  \cref{proposition-exact-sequence-noetherian-module} 与归纳假设即能得到结果.
\end{proof}

假设 \( M \) 是一个 noetherian 环 \( A \) 上的有限生成模. 给定 \( x \in M \),
我们称 \( A \) 的理想
\[
  \operatorname{ann}(x) = \left\lbrace a \in A: ax = 0 \right\rbrace
\]
为 \( x \) 的\emph{零化子}.

\begin{lemma}
  假设 \( M \) 是一个 noetherian 环 \( A \) 上的有限生成模. \( \left\lbrace
  \operatorname{ann}(x) : x \in M \right\rbrace \) 的极大元是素理想.
\end{lemma}
\begin{proof}
  \( A \) noetherian, 故理想集族有极大元. 如果 \( ab \in
  \mathfrak{a} \), 那么 \( abx = 0 \), 只能 \( ax = 0 \) 或 \( bx = 0 \), 否则
  有 \( \operatorname{ann}(x) \subsetneq \operatorname{ann}(ax) \),
  这与极大性矛盾.
\end{proof}

\begin{proposition}
  Noetherian 环 \( A \) 上的有限生成模 \( M \) 有一个有限子模链
  \[
    M \supseteq M_r \supseteq \cdots \supseteq M_1 \supseteq 0
  \]
  使得每个商 \( M_i / M_{i - 1} \) 同构于 \( A / \mathfrak{p}_i \), 其中 \(
  \mathfrak{p}_i \) 为一些素理想.
\end{proposition}
\begin{proof}
  对每个 \( x \in M \), \( M \) 的子模 \( Ax \) 同构于 \( A /
  \operatorname{ann}(x) \). 如果 \( M \) 非零, 那么存在 \( x_1 \) 使得 \(
  \operatorname{ann}(x) \) 为素理想. 令 \( Ax = M_1 \), 这时 \( M_1 = A /
  \operatorname{ann}(x_1) \).

  如果 \( M \neq M_1 \), 我们可以对 \( M / M_1 \) 作相同的讨论, 知道存在 \( x_2
  + M_1 \) 使得 \( \operatorname{ann}(x_2 + M_1) \) 是素的, 且有子模 \( M_2 \)
  使得 \( M_2 / M_1 = A / \operatorname{ann}(x_2 + M_1) \). 如果 \( M_2 / M_1
  \neq M / M_1 \), 那么考察 \( \frac{M / M_1}{M_2 / M_1} \simeq M / M_2, \ldots \)

  我们能够得到一个上升子模链 \( 0 \subseteq M_1 \subseteq M_2 \subseteq \cdots
  \), 使得 \( M_{i -  1} \subsetneq M_{i} \), 且 \( M_{i} / M_{i - 1} \simeq A /
  \mathfrak{p}_{i} \), 其中 \( \mathfrak{p}_i \) 是一些素理想.
  \cref{proposition-finite-generated-module-over-noetherian-ring} 告诉我们, \( M
  \) 是 noetherian 的, 因此这个链有限. 上面的构造在 \( M_n \neq M \)
  时总能继续进行, 因此此链只能终止在 \( M \).
\end{proof}

\subsection{Hilbert 基定理}

\begin{theorem}[Hilbert基]
  \label{theorem-Hilbert-basis}
  每个 noetherian 环上的有限生成代数 noetherian.
\end{theorem}

\begin{corollary}
  如果环 \( A \) notherian, 每个有限生成 \( A \)-代数有限表现.
\end{corollary}
\begin{proof}
  每个有限生成 \( A \)-代数 \( B \) 形如 \( A[X_1, \ldots, X_n] / \mathfrak{a}
  \), \( \mathfrak{a} \) 作为 \( A[X_1, \ldots, X_n] \) 的理想有限生成.
\end{proof}

\section{Nakayama 引理}


\begin{corollary}
  假设 \( A \) 是一个 noetherian 局部环, 其极大理想为 \( \mathfrak{m} \). \(
  \mathfrak{m} \) 元素 \( a_1, \ldots, a_n \) 生成 \( \mathfrak{m} \) 当且仅当
  \( a_1 + \mathfrak{m}^2,\ldots, a_n + \mathfrak{m}^{2} \) 为 \( A /
  \mathfrak{m} \)-线性空间 \( \mathfrak{m} / \mathfrak{m}^2 \) 的一组基. 特别地,
  \( \mathfrak{m} \) 生成元集最小数等于 \( \mathfrak{m} / \mathfrak{m}^2 \)
  维数.
\end{corollary}
\begin{proof}
  考虑 \cref{theorem-Nakayama-lemma}, 令 \( M = \mathfrak{a} = \mathfrak{m},
  N = \left\langle a_1, \ldots, a_n \right\rangle \).
\end{proof}

\section{Krull 维数}

假设 \( A \) 是一个 noetherian 环.
\begin{enumerate}
  \item 给定 \( A \) 的一个素理想 \( \mathfrak{p} \). \( \mathfrak{p} \)
    的\emph{高度 \( \operatorname{ht}(\mathfrak{p}) \)} 定义为最大的长度 \( d \)
    使得互不相同的素理想降链存在
    \[
      \mathfrak{p} = \mathfrak{p}_d \supseteq \mathfrak{p}_{d - 1} \supseteq
      \cdots \supseteq \mathfrak{p}_0.
    \]
  \item \( A \) 的 \emph{Krull 维数} 定义为
    \[
      \sup \left\lbrace \operatorname{ht}(\mathfrak{p}): \mathfrak{p} \subseteq
      A, \text{其中} \mathfrak{p} \text{素} \right\rbrace.
    \]
\end{enumerate}

如果 \( A \) 是一个整环, 那么
\[
  \operatorname{dim} (A) = 0 \iff (0) \text{极大} \iff A \text{是一个域}.
\]
\begin{lemma}
  每个有限生成理想的生成元集包含一个有限的生成元集.
\end{lemma}
\begin{proof}
  令 \( S \) 为理想 \( \mathfrak{a} \) 的一个生成元集, \( \mathfrak{a} \)
  由有限集 \( \left\lbrace a_1, \ldots, a_n \right\rbrace \) 生成. 那么 \( a_i
  \) 有 \( S \) 的有限子集 \( S_i \) 生成. 考察 \( \bigcup S_i \) 即可.
\end{proof}

\begin{theorem}[Krull 交定理]
  \label{theorem-Krull-intersection}
  假设 \( \mathfrak{a} \) 是 noetherian 环 \( A \) 的一个理想. 如果 \(
  \mathfrak{a} \) 包含于所有 \( A \) 的极大理想, 那么
  \[
    \bigcap_{n \geq 1} \mathfrak{a}^n = \left\lbrace 0 \right\rbrace.
  \]
\end{theorem}

\begin{proposition}
  在 noetherian 环中, 每个理想都包含其根的一个幂; 特别地, 幂零根的某个幂就是零.
\end{proposition}
\begin{proof}
  假设 \( a_1, \ldots, a_n \) 生成 \( \operatorname{rad}(\mathfrak{a}) \).
  对每个 \( a_i \) 都存在 \( r_i \) 使得 \( a_i^{r_i} \in \mathfrak{a} \).
  考察 \( r_1 + r_2 + \cdots + r_n \) 即可.
\end{proof}

\section{局部化}

\section{整性}

\subsection{基本性质}

假设 \( A \) 是环 \( B \) 的子环. 一个 \( B \) 的元素 \( \alpha \) 称为在 \( A
\) 上 \emph{整}, 如果他是 \( A \) 的一个首一系数多项式的根,
也就是它满足某个形如下面的方程
\[
  x^n + a_1 x^{n - 1} + \cdots + a_n = 0,\quad a_i \in A.
\]
更一般地, 一个 \( A \)-代数 \( B \) 的元素称为在 \( A \) 上\emph{整}, 如果它在
\( A \) 在 \( B \) 的像中整. 如果 \( B \) 的每个元素都在 \( A \) 中整, 那么称 \( B
\) 在 \( A \) 中\emph{整}.

\begin{lemma}[Cramer]
  \label{lemma-Cramer-varient}
  假设 \( x_j \) 是 \( A \)-系数线性方程
  \[
    \sum_{j = 1}^m c_{ij} x_j = 0,\quad i = 1, \ldots, m,
  \]
  的解, 那么
  \[
    \det(C) \cdot x_j = 0,\quad j = 1,\ldots, m.
  \]
\end{lemma}
\begin{proof}
  考察
  \[
    \det \begin{pmatrix}
      c_{11} &\cdots &c_{1, j - 1} &\sum_{i} &c_{1i} x_{i} &c_{1, j + 1} &\cdots
      &c_{1m}\\ \vdots &&\vdots &\vdots &\vdots &&\vdots\\ c_{m1} &\cdots
      &c_{m, j - 1} &\sum_{i} &c_{mi} x_{i} &c_{m, j + 1} &\cdots &c_{mm}
    \end{pmatrix} = 0
  \]
\end{proof}

\begin{proposition}
  \label{proposition-integral-iff-condition}
  假设环 \( B \) 是 \( A \) 的扩张. \( B \) 的一个元素 \( \alpha \) 在 \( A \)
  上整当且仅当存在 \( B \) 的忠实 \( A[\alpha] \)-子模作为 \( A \)-模有限生成.
\end{proposition}
\begin{proof}
  \( \implies \) 考虑 \( A[\alpha] \) 即可. \( \impliedby \) 假设 \( C \) 作为
  \( A[\alpha] \) 由一族极小生成元 \( c_1,\ldots, c_n \) 生成, 那么
  \[
    \alpha c_i = a_{i1}c_1 + a_{i2}c_2 + \cdots + a_{in}c_n
  \]
  记
  \[
    C = \begin{pmatrix}
      \alpha - a_{11} &-a_{12} &\cdots &-a_{1n}\\
      -a_{21} &\alpha - a_{12} &\cdots &-a_{2n}\\
      \vdots &\vdots &\ddots &\vdots\\
      -a_{n1} &-a_{n2} &\cdots &\alpha-a_{nn}\\
    \end{pmatrix}
  \]
  由 \cref{lemma-Cramer-varient}, \( \det(C) e_i = 0 \). 由忠实性, \( \det(C) = 0 \), 展开 \(
  \det(C) \), 可以找到 \( b \) 满足一个首一 \( A \)-系数多项式.
\end{proof}


\begin{proposition}
  如果 \( A \)-代数 \( B \) 有限生成且每个元素都在 \( A \) 上整, 那么 \( B \)
  作为 \( A \)-模有限.
\end{proposition}
\begin{proof}
  假设 \( B \) 由 \( \alpha_1, \ldots, \alpha_m \) 生成, 并且
  \[
    \alpha_i^{n_i} + a_{i1}\alpha_{i}^{n_i - 1} + \cdots + a_{in_i} =
    0,\quad a_{ij} \in A,\quad i = 1,\ldots, m.
  \]
  考察 \( \alpha_1^{r_i}\cdots \alpha_m^{r_m}, 1 \leq r_i < n_i \).
\end{proof}

\begin{corollary}
  考虑环 \( A \subseteq B \subseteq C \).  \( B \) 在 \( A \) 上整并且 \( C \)
  在 \( B \) 上整当且仅当 \( C \) 在 \( A \) 上整.
\end{corollary}
\begin{proof}
  \( \implies \) 假设 \( c \in C \) 满足
  \[
    c^{n} + b_{1}c_{i}^{n - 1} + \cdots + b_{n} =
    0,\quad b_{i} \in B,\quad i = 1,\ldots, n.
  \]
  考察 \( A[b_1, b_2, \ldots, b_n, c] = A[b_1, b_2, \ldots, b_n][c] \).
\end{proof}

\begin{theorem}
  假设 \( A \) 为 \( B \) 的子环, 那么 \( B \) 在 \( A \) 上的整的元素构成一个
  \( B \) 的 \( A \)-子代数.
  我们称 \( A \) 在 \( B \) 的 \emph{整闭包} 为 \( B \) 在 \( A \)
  中的所有整元素. 特别地, 在没有歧义的情况下, 如果 \( A \) 是一个整环, \( A \)
  在其分式域的整闭包称为 \( A \) 的 \emph{整闭包}.
\end{theorem}
\begin{proof}
  假设 \( B \) 的两个元素 \( \alpha, \beta \) 在 \( A \) 上整, 考察 \( A[\alpha,
  \beta] = A[\alpha][\beta] \).
\end{proof}

\subsection{整闭包}

\begin{proposition}
  假设 \( A \) 是一个整环, 其分式域为 \( F \), \( E \) 是一个包含 \( F \) 的域.
  如果 \( \alpha \in E \) 在 \( F \) 上代数, 那么存在\( d \in A \) 使得 \( d
  \alpha \) 在 \( A \) 上整.
\end{proposition}

\begin{corollary}
  如果 \( A \) 是一个整环, \( E \) 是 \( A \) 的分式域的整扩张, 那么 \( E \)
  是 \( A \) 在 \( E \) 中整闭包的分式域.
\end{corollary}

一个整环 \( A \) 称为是 \emph{整闭的} 或者 \emph{正规的},
如果它等于它在自身分式域上的整闭包, 换句话说
\[
  \alpha \in F,\quad \alpha \text{在} A \text{中整} \implies \alpha \in A.
\]

\begin{proposition}
  每个唯一因子分解整环都是整闭的.
\end{proposition}
\begin{proof}
  假设 \( A \) 是一个唯一因子分解整环, \( a/b \in \operatorname{Frac} A \) 整,
  其中 \( a \) 和 \( b \) 互素, 那么其满足形如下面的方程
  \[
    \left(\frac{a}{b}\right)^n + a_1 \left(\frac{a}{b}\right)^{n - 1} + \cdots + a_n = 0,\quad a_i \in
    A.
  \]
  两边同乘 \( b^n \), 得到
  \[
    a^n + (a_1b) a^{n - 1} + \cdots + a_nb^n = 0,\quad a_i \in
    A.
  \]
  因此 \( b \mid a \), 只能 \( b \) 为 \( A \) 的单位.
\end{proof}

假设 \( F \subseteq E \) 均为域, \( \alpha \in E \) 在 \( F \) 上代数. \( \alpha
\) 在 \( F \) 上的 \emph{极小多项式} 是首一的 \( \alpha \) 的最小多项式.

\begin{proposition}
  假设 \( A \) 是一个正规整环, \( E \) 是 \( A \) 的分式域 \( F \)
  的一个有限扩张. \( E \) 的一个元素 \( \alpha \) 在 \( A \) 上整当且仅当其在 \(
  F \) 上的极小多项式系数均在 \( A \) 上.
\end{proposition}
\begin{proof}
  只需验证 \( \implies \).
  假设 \( \alpha \) 在 \( A \) 上整, \( \alpha_1, \ldots, \alpha_n \) 为 \(
  \alpha \) 在 \( \operatorname{Frac} A \) 上的共轭根, 它们在同一个首一 \( A
  \)-系数多项式下为零, 故都是整的.
  \( \alpha \) 的极小多项式在 \( F \) 关于 \( \alpha \)
  的分裂域中具有形式(可以参考\cite{Hungerford2011-ze}推论6.14)
  \[
    ((X - \alpha_1)\cdots(X - \alpha_n))^{[K(\alpha_1):K]_i}
  \]
  其中 \( [K(u_1):K]_i \) 为 \( K(u_1)/K \) 的不可分次数, 于是其系数都在 \( A \)
  中整, 而 \( A \) 整闭, 所以都落在 \( A \) 中.
\end{proof}

\begin{corollary}
  假设 \( A \) 是一个分式域为 \( F \) 的整闭整环, \( f \) 是 \( A[X] \)
  的一个首一系数多项式. 那么 \( f \) 在 \( F[X] \) 中的每个首一系数因子系数都在
  \( A \) 中.
\end{corollary}

\begin{proposition}
  假设 \( A \subseteq B \) 为环, \( A' \) 为 \( A \) 在 \( B \) 的整闭包.
  对每个 \( A \) 的乘性子集 \( S \), \( S^{-1}A' \) 为 \( S^{-1} A \) 在 \(
  S^{-1} B \) 的整闭包.
\end{proposition}
\begin{proof}
  假设 \( b/s \in S^{-1}A' \) 其中 \( b \in A' \) 和 \( s \in S \), 那么有
  \[
    b^n + a_1 b^{n - 1} + \cdots + a_n = 0,\quad a_i \in A,
  \]
  因此
  \[
    \left(\frac{b}{s}\right)^n + \frac{a_1}{s} \left( \frac{b}{s} \right)^{n -
    1} + \cdots + \frac{a_n}{s^n} = 0
  \]
  \( b/s \) 在 \( S^{-1}A \) 上整.

  反过来, 假设 \( b / s(b \in B, s \in S) \) 在 \( S^{-1}A \) 上整, 那么有
  \[
    \left( \frac{b}{s} \right)^n + \frac{a_1}{s_1} \left( \frac{b}{s} \right)^{n
    - 1} + \cdots + \frac{a_n}{s_n} = 0,\quad a_i \in A,\quad s_i S.
  \]
  同乘 \( s^n s_1^n \cdots s_n^n \), 知道 \( s_1 \cdots s_n b \in A' \).
\end{proof}

\begin{corollary}
  假设 \( A \subseteq B \) 是环, \( S \) 是 \( A \) 的一个乘性子集. 如果 \( A \)
  在 \( B \) 中正闭, 那么 \( S^{-1} A \) 在 \( S^{-1} B \) 中正闭.
\end{corollary}

\begin{proposition}
  假设 \( A \) 是一个整环, 那么下面条件等价
  \begin{enumerate}
    \item \( A \) 整闭.
    \item 对所有素理想 \( \mathfrak{p} \), \( A_{\mathfrak{p}} \) 整闭.
    \item 对所有极大理想 \( \mathfrak{m} \), \( A_{\mathfrak{m}} \) 整闭.
  \end{enumerate}
\end{proposition}
\begin{proof}
  (iii) \( \implies \) (i), 假设 \( A' \) 为 \( A \) 的整闭包. \(
  A_{\mathfrak{m}} \to (A')_{\mathfrak{m}} \) 满, 进而 \( A \to A' \) 满.
\end{proof}

\begin{lemma}
  如果 \( A \) 是一个环, \( B \) 是一个 \( A \)-代数且 \( f, g \in B[T] \)
  为首一系数多项式使得 \( g \mid f \). 如果 \( f \) 的系数在 \( A \) 上整, 那么
  \( g \) 的系数也在 \( A \) 上整.
\end{lemma}
\begin{proof}
  %TODO: 域论
\end{proof}

\begin{proposition}
  假设 \( B \) 是一个 \( A \)-代数. 如果 \( B[T] \) 的一个多项式 \( f \) 在 \(
  A[T] \) 中整, 那么 \( f \) 的系数都在 \( A \) 中整.
\end{proposition}
\begin{proof}
  假设 \( P \in B[T] \) 为多项式
  \[
    q(X) = X^n + f_1 X^{n - 1} + \cdots + f_n,\quad f_i \in A[T]
  \]
  的根. 令 \( r \) 为一个大于 \( \deg f_1,\ldots, \deg f_n \) 的整数, \( P_1
  = P - T^r \), 以及
  \[
    q_1(X) = q(X + T^r) = X^n + g_1 X^{n - 1} + \cdots + g_n,\quad g_i \in A[T].
  \]
  那么 \( P_1 \) 为 \( q_1(X) \) 的一个根, 因此
  \[
    g_n = -P_1 \cdot (P^{n - 1}_1 + g_1 P^{n - 2}_1 + \cdots + g_{n - 1}).
  \]
  由 \( r \) 的选择知道, \( g_n \) 都是首一的. 由 \( g_n \) 系数在 \( A \)
  中知道 \( P_1 \) 系数在 \( A \) 中整, 因此 \( P \) 系数在 \( A \) 中整.
\end{proof}

\begin{proposition}
  整闭整环的多项式环都是整闭整环.
\end{proposition}
\begin{proof}
  只需证明, 如果 \( A \) 是一个整闭整环, 那么 \( A[T] \) 亦是一个整闭整环. 假设
  \( F \) 是 \( A \) 的分式域. 如果 \( A[T] \) 的分式域 \( F(T) \) 的一个元素 \(
  f \) 在 \( A[T] \) 中整, 那么它在 \( F[T] \) 中整. 而 \( F[T] \)
  是一个唯一因子分解整环, 其分式域亦为 \( F(T) \), 因此 \( f \in F[T] \). 因此,
  \( f \) 系数在 \( A \) 中整, 换句话说, \( f \in A[T] \).
\end{proof}

\subsection{上升下降定理}

\begin{proposition}
  如果 \( A \subseteq B \) 为整环, \( B \) 在 \( A \) 上整, 那么 \( B \)
  是一个域当且仅当 \( A \) 是一个域.
\end{proposition}
\begin{proof}
  \( \implies \). 假设 \( 0 \neq \alpha \in A \), 那么 \( \alpha^{-1} \in B \)
  在 \( A \) 上整. 因此存在 \( \alpha_i \in A \) 使得
  \[
    (\alpha^{-1})^n + a_1(\alpha^{-1})^{n - 1} + \cdots + a_n = 0.
  \]
  两边同乘 \( a^{n - 1} \) 立刻知道 \( \alpha^{-1} \in A \).

  \( \impliedby \). 假设 \( 0 \neq \alpha \in B \) 在 \( A \) 上整,
  那么能找到一个 \( \alpha \) 次数最低的方程
  \[
    \alpha^n + a_1\alpha^{n - 1} + \cdots + a_n = 0,\quad a_i \in A.
  \]
  显然 \( a_n \neq 0 \), 因此
  \[
    (-a_n)^{-1}(\alpha^{n - 1} + a_1\alpha^{n - 2} + \cdots + a_{n - 1})\alpha =
    1,
  \]
  也就是 \( \alpha \) 在 \( B \) 中有逆.
\end{proof}

\begin{corollary}
  假设 \( A \subseteq B \) 且 \( B \) 在 \( A \) 上整, \( \mathfrak{q} \) 为\( B
  \) 的一个素理想, \( \mathfrak{p} = \mathfrak{q} \cap A \). 那么 \(
  \mathfrak{q} \) 极大当且仅当 \( \mathfrak{p} \) 极大.
\end{corollary}
\begin{proof}
  考虑 \(  A / \mathfrak{p} \hookrightarrow B / \mathfrak{q} \).
\end{proof}

\begin{corollary}[不相容性]
  假设 \( A \subseteq B \) 为环, \( B \) 在 \( A \) 上整, 并且 \( \mathfrak{q}
  \subseteq \mathfrak{q}' \) 为 \( B \) 的素理想. 如果 \( \mathfrak{q} \cap A =
  \mathfrak{q}' \cap A \), 那么 \( \mathfrak{q} = \mathfrak{q}' \).
\end{corollary}
\begin{proof}
  设 \( \mathfrak{p} = \mathfrak{q} \cap A = \mathfrak{q}' \cap A \). 那么 \(
  A_{\mathfrak{p}} \subseteq B_{\mathfrak{p}} \) 且 \( B_{\mathfrak{p}} \) 在 \(
  A_{\mathfrak{p}} \) 上整. 理想 \( \mathfrak{q} B_{\mathfrak{p}}   \subseteq
  \mathfrak{q}' B_{\mathfrak{p}} \) 均为 \( B_{\mathfrak{p}} \) 的素理想且交 \(
  A_{\mathfrak{p}}\) 于 \( \mathfrak{p}A_{\mathfrak{p}} \), 后者为 \(
  \mathfrak{p}A_{\mathfrak{p}} \) 的极大理想. 因此 \( \mathfrak{q}
  B_{\mathfrak{p}} = \mathfrak{q}' B_{\mathfrak{p}} \) 均为极大理想.
  因此有收缩的等式
  \[
    \mathfrak{q} = (\mathfrak{q}B_{\mathfrak{p}})^c =
    (\mathfrak{q}'B_{\mathfrak{p}})^c = \mathfrak{q}'.
  \]
\end{proof}

\begin{proposition}
  假设 \( A \subseteq B \) 为环且 \( B \) 在 \( A \) 上整且 \( \mathfrak{p} \)
  为 \( A \) 的素理想. 那么存在 \( B \) 的素理想 \( \mathfrak{q} \) 使得 \(
  \mathfrak{p} = \mathfrak{q} \cap A \).
\end{proposition}
\begin{proof}
  由假设我们有 \( A_{\mathfrak{p}} \subseteq B_{\mathfrak{p}} \), 且 \(
  B_{\mathfrak{p}} \) 在 \( A_{\mathfrak{p}} \) 上整. 假设 \( \mathfrak{n} \) 为
  \( B_{\mathfrak{p}} \) 的一个极大理想, \( \mathfrak{q} = \mathfrak{n} \cap B
  \). 由下图可以知道 \( \mathfrak{q} \cap A = \mathfrak{p} \).
  % https://q.uiver.app/#q=WzAsNCxbMCwxLCJBIl0sWzEsMSwiQV97XFxtYXRoZnJha3twfX0iXSxbMSwwLCJCX3tcXG1hdGhmcmFre3B9fSJdLFswLDAsIkIiXSxbMCwzXSxbMCwxXSxbMSwyXSxbMywyXV0=
  \[\begin{tikzcd}
    B & {B_{\mathfrak{p}}} \\
    A & {A_{\mathfrak{p}}}
    \arrow[from=1-1, to=1-2]
    \arrow[from=2-1, to=1-1]
    \arrow[from=2-1, to=2-2]
    \arrow[from=2-2, to=1-2]
  \end{tikzcd}\]
\end{proof}

\begin{theorem}
  假设 \( A \subseteq B \) 为环并且 \( B \) 在 \( A \) 上整. 如果 \(
  \mathfrak{p} \subseteq \mathfrak{p}' \) 为 \( A \) 的素理想且 \( \mathfrak{q}
  \) 为 \( B \) 的素理想使得 \( \mathfrak{q} \cap A = \mathfrak{p} \), 那么存在
  \( B \) 的素理想 \( \mathfrak{q}' \) 使得 \( \mathfrak{q}' \cap A =
  \mathfrak{p}' \).
  % https://q.uiver.app/#q=WzAsNixbMCwwLCJCIl0sWzAsMSwiQSJdLFsxLDAsIlxcbWF0aGZyYWt7cX0iXSxbMSwxLCJcXG1hdGhmcmFre3B9Il0sWzIsMCwiXFxtYXRoZnJha3txfSciXSxbMiwxLCJcXG1hdGhmcmFre3B9JyJdLFszLDUsIlxcc3Vic2V0IiwxLHsic3R5bGUiOnsiYm9keSI6eyJuYW1lIjoibm9uZSJ9LCJoZWFkIjp7Im5hbWUiOiJub25lIn19fV0sWzIsNCwiXFxzdWJzZXQiLDEseyJzdHlsZSI6eyJib2R5Ijp7Im5hbWUiOiJub25lIn0sImhlYWQiOnsibmFtZSI6Im5vbmUifX19XSxbMywyLCIiLDEseyJzdHlsZSI6eyJoZWFkIjp7Im5hbWUiOiJub25lIn19fV0sWzUsNCwiIiwxLHsic3R5bGUiOnsiYm9keSI6eyJuYW1lIjoiZGFzaGVkIn0sImhlYWQiOnsibmFtZSI6Im5vbmUifX19XSxbMSwwLCIiLDEseyJzdHlsZSI6eyJoZWFkIjp7Im5hbWUiOiJub25lIn19fV1d
  \[\begin{tikzcd}
    B & {\mathfrak{q}} & {\mathfrak{q}'} \\
    A & {\mathfrak{p}} & {\mathfrak{p}'}
    \arrow["\subset"{description}, draw=none, from=1-2, to=1-3]
    \arrow[no head, from=2-1, to=1-1]
    \arrow[no head, from=2-2, to=1-2]
    \arrow["\subset"{description}, draw=none, from=2-2, to=2-3]
    \arrow[dashed, no head, from=2-3, to=1-3]
  \end{tikzcd}\]
\end{theorem}
\begin{proof}
  考察 \( A / \mathfrak{p} \hookrightarrow B / \mathfrak{q} \), 存在素理想 \(
  \mathfrak{q}'' \in B / \mathfrak{q} \) 使得 \( \mathfrak{q}'' \cap (A /
  \mathfrak{p}) = \mathfrak{p}' / \mathfrak{p} \), 考虑下面的交换图即可.
  % https://q.uiver.app/#q=WzAsNCxbMCwxLCJBIl0sWzEsMSwiQS9cXG1hdGhmcmFre3B9Il0sWzEsMCwiQi9cXG1hdGhmcmFre3F9Il0sWzAsMCwiQiJdLFswLDNdLFswLDFdLFsxLDJdLFszLDJdXQ==
  \[\begin{tikzcd}
    B & {B/\mathfrak{q}} \\
    A & {A/\mathfrak{p}}
    \arrow[from=1-1, to=1-2]
    \arrow[from=2-1, to=1-1]
    \arrow[from=2-1, to=2-2]
    \arrow[from=2-2, to=1-2]
  \end{tikzcd}\]
\end{proof}

\begin{corollary}
  假设 \( A \subseteq B \) 为环且 \( B \) 在 \( A \) 上整, 且 \( \mathfrak{p}_1
  \subseteq \cdots \subseteq \mathfrak{p}_n \) 为 \( A \) 的素理想.
  令素理想包含链
  \[
    \mathfrak{q}_1 \subseteq \cdots \subseteq \mathfrak{q}_m \quad (m < n)
  \]
  为 \( B \) 的素理想使得 \( \mathfrak{q}_i \cap A = \mathfrak{p} \) 对所有 \( i
  \leq m \) 成立, 那么此素理想包含链可以扩张为
  \[
    \mathfrak{q}_1 \subseteq \cdots \subseteq \mathfrak{q}_n
  \]
  使得 \( \mathfrak{q}_i \cap A = \mathfrak{p} \), 其中 \( i \leq n \).
\end{corollary}

\paragraph{理想上整} 假设 \( A \subseteq B \) 为环, \( \mathfrak{a} \) 为
\( A \) 的一个理想. \( B \) 的一个元素 \( b \) 称为在 \( \mathfrak{a} \)
上\emph{整}, 如果其满足方程
\[
  b^n + a_1 b^{n - 1} + \cdots + a_n = 0,
\]
其中 \( a_i \in \mathfrak{a} \). \( B \) 在 \( \mathfrak{a} \) 上的
\emph{整闭包} 为 \( B \) 在 \( \mathfrak{a} \) 上整的元素.

类似于 \cref{proposition-integral-iff-condition}, 我们可以知道
\begin{proposition}
  如果一个 \( B \) 的忠实 \( A[b] \)-子模 \( M \), 其作为 \( A \)-模有限生成,
  使得 \( b M \subseteq \mathfrak{a} M \), 那么 \( b \in B \) 在 \( \mathfrak{a}
  \) 上整.
\end{proposition}

\begin{lemma}
  如果 \( A \) 在 \( B \) 的整闭包为 \( A' \), 那么 \( \mathfrak{a} \) 在 \( B
  \) 中的整闭包是 \( \operatorname{rad}(\mathfrak{a}A') \).
\end{lemma}
\begin{proof}
  如果 \( b \in B \) 在 \( \mathfrak{a} \) 上整. 我们知道 \( b \in A' \) 且 \(
  b^n \in \mathfrak{a} A' \), 因此 \( b \in \operatorname{rad}(\mathfrak{a}A')
  \).

  反过来, 如果 \( b \in \operatorname{rad}(\mathfrak{a} A') \), 使得
  \[
    b^m = \sum_i a_i x_i,\quad \text{其中} m > 0,\quad a_i \in
    \mathfrak{a},\quad x_i \in A'.
  \]
  因为 \( x_i \) 在 \( A \) 整, 考虑 \( M = A[x_1, \ldots, x_n] \)
  是一个有限生成代数. 因为 \( b^m M \subseteq \mathfrak{a} M \), 我们知道 \( b^m
  \) 在 \( \mathfrak{a} \) 上整, 因此 \( b \) 在 \( \mathfrak{a} \) 上整.
\end{proof}

\begin{proposition}
  假设 \( A \) 是一个整闭整环, \( E \) 是 \( A \) 的分式域的扩张, \( \alpha \in
  E \).
  如果  \( \alpha \) 在 \( A \) 的理想 \( \mathfrak{a} \) 上整,
  那么 \( \alpha \) 在 \( F \) 的极小多项式系数都在 \(
  \operatorname{rad}(\mathfrak{a}) \) 上.
\end{proposition}
\begin{proof}
  %TODO: 域论
  % 假设 \( \alpha \) 在 \( \mathfrak{a} \) 上整, 使得
  % \[
  %   \alpha^n + a_1 \alpha^{n - 1} + \cdots + a_n = 0,\quad n > 0,\quad a_i \in
  %   \mathfrak{a}.
  % \]
\end{proof}

\begin{theorem}
  假设 \( A \subseteq B \) 为整环, 且 \( A \) 整闭, \( B \) 在 \( A \) 上整.
  如果 \( \mathfrak{p} \supseteq \mathfrak{p}' \) 为 \( A \) 的素理想, \(
  \mathfrak{q} \) 为 \( B \) 的素理想使得 \( \mathfrak{q} \cap A = \mathfrak{p}
  \). 那么 \( \mathfrak{q} \) 包含一个 \( B \) 的素理想 \( \mathfrak{q}' \) 使得
  \( \mathfrak{q}' \cap A = \mathfrak{p}' \).
  % https://q.uiver.app/#q=WzAsNixbMCwwLCJCIl0sWzAsMSwiQSJdLFsxLDAsIlxcbWF0aGZyYWt7cX0iXSxbMSwxLCJcXG1hdGhmcmFre3B9Il0sWzIsMCwiXFxtYXRoZnJha3txfSciXSxbMiwxLCJcXG1hdGhmcmFre3B9JyJdLFszLDUsIlxcc3Vwc2V0IiwxLHsic3R5bGUiOnsiYm9keSI6eyJuYW1lIjoibm9uZSJ9LCJoZWFkIjp7Im5hbWUiOiJub25lIn19fV0sWzIsNCwiXFxzdXBzZXQiLDEseyJzdHlsZSI6eyJib2R5Ijp7Im5hbWUiOiJub25lIn0sImhlYWQiOnsibmFtZSI6Im5vbmUifX19XSxbMywyLCIiLDEseyJzdHlsZSI6eyJoZWFkIjp7Im5hbWUiOiJub25lIn19fV0sWzUsNCwiIiwxLHsic3R5bGUiOnsiYm9keSI6eyJuYW1lIjoiZGFzaGVkIn0sImhlYWQiOnsibmFtZSI6Im5vbmUifX19XSxbMSwwLCIiLDEseyJzdHlsZSI6eyJoZWFkIjp7Im5hbWUiOiJub25lIn19fV1d
  \[\begin{tikzcd}
    B & {\mathfrak{q}} & {\mathfrak{q}'} \\
    A & {\mathfrak{p}} & {\mathfrak{p}'}
    \arrow["\supset"{description}, draw=none, from=1-2, to=1-3]
    \arrow[no head, from=2-1, to=1-1]
    \arrow[no head, from=2-2, to=1-2]
    \arrow["\supset"{description}, draw=none, from=2-2, to=2-3]
    \arrow[dashed, no head, from=2-3, to=1-3]
  \end{tikzcd}\]
\end{theorem}
\begin{proof}
  \( B \) 的包含在 \( \mathfrak{q} \) 的素理想与 \( B_{\mathfrak{q}} \)
  的素理想一一对应, 因此我们只需要证明 \( \mathfrak{p}' \) 为 \(
  B_{\mathfrak{q}} \) 的一个素理想的收缩, 或者由
  \cref{proposition-integral-iff-condition} 等价地,
  \[
    A \cap \mathfrak{p}' B_{\mathfrak{q}} = \mathfrak{p}'
  \]
  如果 \( b \in \mathfrak{p}' B_{\mathfrak{q}} \), 那么 \( b = y/s \), 其中 \( y
  \in \mathfrak{p}'B, s \in B \setminus \mathfrak{q} \). \( y \) 在 \(
  \mathfrak{p}' \) 整, 满足
  \[
    y^m + a_1 y^{m - 1} + \cdots + a_m = 0,
  \]
  其中 \( a_i \in \operatorname{rad}(\mathfrak{p}') = \mathfrak{p}' \).

  假设 \( b \in A \cap \mathfrak{p}' B_{\mathfrak{q}} \), 那么 \( b^{-1} \in F =
  \operatorname{Frac} A \), 将上式的 \( y \) 替换为 \( bs \) 在除去 \( b^m \)
  得到
  \[
    s^m + (a_1 / b) s^{m - 1} + \cdots + (a_m / b^m) = 0.
  \]
  可以知道这对应 \( s \) 在 \( F \) 的极小多项式, 结合 \( s \) 在 \( A \) 中整,
  知道 \( a_i / b^i \in A \). 假设 \( b \notin \mathfrak{p}' \), 系数 \( a_i /
  b^i \in \mathfrak{p}' \)(否则 \( a_i \notin \mathfrak{p}' \)), 因而 \( s^m \in
  \mathfrak{p}' B \subseteq \mathfrak{p} B \subseteq \mathfrak{q} \), 因此 \( s
  \in \mathfrak{q} \), 矛盾. 因此 \( b \in \mathfrak{p}' \), 换句话说 \( A \cap
  \mathfrak{p}' B_{\mathfrak{q}}= \mathfrak{p}' \).
\end{proof}

\begin{corollary}
  假设 \( A \subseteq B \) 为整环, \( A \) 整闭且 \( B \) 在 \( A \) 上整. 如果
  \( \mathfrak{p}_1 \supseteq \cdots \supseteq \mathfrak{p}_n \) 为 \( A \)
  的素理想, 且令
  \[
    \mathfrak{q}_1 \supseteq \cdots \supseteq \mathfrak{q}_m \quad (m < n)
  \]
  为 \( B \) 的素理想使得对所有 \( i \) 都有 \( \mathfrak{q}_i \cap A =
  \mathfrak{p}_i \), 那么存在素理想链扩张
  \[
    \mathfrak{q}_1 \supseteq \cdots \supseteq \mathfrak{q}_n
  \]
  使得 \( \mathfrak{q}_i \cap A = \mathfrak{p} \) 对所有 \( i \) 成立.
\end{corollary}

\section{域上有限生成代数定理若干}

\subsection{Noether 正规定理}

\begin{lemma}
  假设 \( f \in k[X_1, \ldots, X_d, T] \). 对恰当的 \( m \in \mathbb{N} \),
  \[
    f\left(X_1 + T^m, X_2 + T^{m^2}, \ldots, X_d + T^{m^d}, T\right)
  \]
  形如 \( c_0 T^r + c_1 T^{r - 1} + \cdots + c_r \) 其中 \( c_0 \in k^{\times}
  \).
\end{lemma}

\begin{lemma}
  假设 \( A = k[x_1, \ldots, x_n] \) 是一个有限生成 \( k \)-代数, 令 \(
  \left\lbrace x_1, \ldots, x_d \right\rbrace \) 为 \( \left\lbrace x_1, \ldots,
  x_n \right\rbrace \) 的极大代数独立子集. 如果 \( n > d \), 那么存在一个 \( m
  \in \mathbb{N} \) 使得 \( A \) 在子代数 \( k\left[x_1 - x_n^m,\ldots, x_d -
  x_n^{m^d}, x_{d + 1}, \ldots, x_{n - 1}\right] \).
\end{lemma}

\begin{theorem}[Noether正规定理]
  每个域 \( k \) 上的有限生成代数包含一个多项式代数 \( R \), 使得 \( A \) 是一个
  \( R \)-代数. 换句话说, 存在 \( A \) 的元素 \( y_1, \ldots, y_r \) 在 \( k \)
  中代数独立, 使得 \( A \) 在 \( k[y_1, \ldots, y_r] \) 上有限.
\end{theorem}

\subsection{Nakayama 引理}

\begin{theorem}[Zariski 引理]
  \label{theorem-Zariski-lemma}
  假设 \( K/k \) 为域扩张.
  如果 \( K \) 是有限生成 \( k \)-代数, 那么 \( K \) 在 \( k \) 上代数.
  特别地, \( K \) 在 \( k \) 上有限.
\end{theorem}
\begin{proof}
  设 \( K = k[x_1, \ldots, x_r] \), 其中 \( x_1, \ldots, x_r \) 为 \( K \)
  的一组 \( k \)-最小生成元, 下面对 \( r \) 作归纳.
  \( r = 0 \) 的情况平凡.

  考虑 \( r \geq 1 \).
  如果 \( K \) 不在 \( k \) 上代数, 那么存在至少一个 \( x_i \) 不在 \( k \)
  上代数, 通过一个置换不妨设其为 \( x_1 \).
  于是 \( k[x_1] \) 是带一个未定元的 \( k \) 多项式环, 且 \( K \) 是一个有限生成
  \( k(x_1) \)-代数, 其一组生成元为 \( x_2, \ldots, x_r \).
  于是由归纳假设 \( x_2, \ldots, x_r \) 在 \( k(x_1) \) 上代数.
  因此存在 \( c \in k[x_1] \) 使得 \( cx_2, \ldots, cx_r \) 在 \( k[x_1] \)
  上整.

  对任意 \( f \in k(x_1) \subseteq K = k[x_1, \ldots, x_r] \), 存在足够大的 \( N
  \) 使得 \( c^N f \in k[x_1, cx_2, \ldots, cx_r] \).
  于是 \( c^N f \) 在 \( k[x_1] \) 上整.
  而 \( k[x_1] \) 作为域上多项式环是一个唯一因子分解整环, 是整闭的, 于是 \( c^N
  f \in k[x_1] \) 这与 \( k[x_1] \) 有无穷多个不可约元矛盾.
\end{proof}
%TODO: 分别考虑是不是代数闭域

\begin{corollary}
  假设 \( A \) 是一个有限生成 \( k \)-代数.
  \( A \) 的每个极大理想 \( \mathfrak{m} \) 都是 \( A \) 到某个 \( k
  \)-有限生成扩域的同态核.
\end{corollary}

\begin{corollary}
  假设 \( k \subseteq K \subseteq A \) 为 \( k \)-代数, \( K \) 是一个域, \( A
  \) 为一个 \( k \)-上有限生成代数.
  那么 \( K \) 在 \( k \) 上代数.
\end{corollary}
\begin{proof}
  假设 \( \mathfrak{m} \) 为 \( A \) 的一个极大理想, 那么 \( K \cap \mathfrak{m}
  = (0) \) 于是 \( k \subseteq K \subseteq A/\mathfrak{m} \).
  由\cref{theorem-Zariski-lemma} \( A/\mathfrak{m} \) 在 \( k \) 上代数, 所以 \(
  K \) 在 \( k \) 上代数.
\end{proof}

\subsection{零点定理}

\begin{theorem}[Nullstellensatz]
  \label{theorem-Nullstellensatz}
  假设 \( k \) 为一个域, \( \overline{k} \) 为其代数闭包.
  \( k[X_1, \ldots, X_n] \) 中的每个真理想都在 \( \overline{k}^n \)
  中有公共零点.
  换句话说, 存在 \( (a_1, \ldots, a_n) \in \overline{k}^n \) 使得 \( f(a_1,
  \ldots, a_n) = 0 \) 对所有 \( f \in \mathfrak{a} \) 成立.
\end{theorem}
\begin{proof}
  考虑找到一个 \( k \)-代数同态 \( \varphi: k[X_1, \ldots, X_n] \to \overline{k}
  \), 其核包含 \( \mathfrak{a} \).
  如果能找到这样的 \( \varphi \), 设 \( \alpha_i = \varphi(X_i) \).
  那么对任意 \( f \in \mathfrak{a} \), 则 \( 0 = \varphi f(X_1, \ldots, X_n) =
  f(\alpha_1, \ldots, \alpha_n) \).

  假设 \( \mathfrak{m} \) 是 \( k[X_1, \ldots, X_n] \) 的一个极大理想, 那么域 \( K
  = k[X_1, \ldots, X_n]/ \mathfrak{m} \) 是一个有限生成 \( k \)-代数.
  由\cref{theorem-Zariski-lemma}, \( K \) 在 \( k \) 上代数, 于是有嵌入 \( K
  \hookrightarrow \overline{k} \).
  考虑复合 \( k \to K \hookrightarrow \overline{k} \) 即可.
\end{proof}

\begin{corollary}
  如果 \( k \) 代数闭, 那么 \( k[X_1, \ldots, X_n] \) 的所有极大理想即
  \[
    \left\lbrace (X_1 - a_1,\ldots, X_n - a_n): (a_1, \ldots, a_n) \in k^n
    \right\rbrace.
  \]
\end{corollary}
\begin{proof}
  \( (X_1 - a_1,\ldots, X_n - a_n) \) 为 \( k[X_1, \ldots, X_n] \)
  极大理想是因为 \( k[X_1, \ldots, X_n]/(X_1 - a_1,\ldots, X_n - a_n) \simeq k
  \).

  假设 \( \mathfrak{m} \) 是 \( K[X_1, \ldots, X_n] \) 的一个极大理想.
  由\cref{theorem-Nullstellensatz}, \( \mathfrak{m} \) 有公共零点 \( (a_1,
  \ldots, a_n) \in k^n \).
  将 \( f \in K[X_1, \ldots, X_n] \) 写成 \( X_i - a_i \) 的多项式, 其常数项即
  \( f(a_1, \ldots, a_n) \).
  于是对 \( f \in \mathfrak{m} \) 有 \( f(a_1, \ldots, a_n) = 0 \), 换句话说 \(
  \mathfrak{m} \subseteq (X_1 - a_1, \ldots, X_n - a_n) \), 结合极大性,
  只能相等.
\end{proof}

\begin{theorem}[强 Nullstellensatz]
  \label{theorem-strong-Nullstellensatz}
  假设 \( \mathfrak{a} \) 为 \( k[X_1, \ldots, X_n] \) 的任意理想.
  假设 \( Z(\mathfrak{a}) \) 为 \( \mathfrak{a} \) 在 \( \overline{k}^n \)
  的所有公共零点集.
  如果一个多项式 \( h \in k[X_1, \ldots, X_n] \) 在 \( Z(\mathfrak{a}) \)
  中取值均为零, 那么 \( h \in \operatorname{rad}(\mathfrak{a}) \).
\end{theorem}
\begin{proof}
  只需证明 \( h \neq 0 \) 的情况.
  由\cref{theorem-Hilbert-basis}, \( k[X_1, \ldots, X_n] \) noetherian, 于是 \(
  \mathfrak{a} \) 有限生成, 设其由 \( g_1, \ldots, g_m \) 生成.
  考虑下面关于变元 \( X_1, \ldots, X_n, Y \) 的方程组
  \[
    \begin{split}
      g_i(X_1, \ldots, X_n) &= 0, i = 1, \ldots, m\\
      1 - Yh(X_1, \ldots, X_n) &= 0.
    \end{split}
  \]
  这样的方程组是没有解的: 如果 \( (a_1, \ldots, a_n, b) \) 满足前 \( m \) 个,
  那么 \( (a_1, \ldots, a_n) \in \mathfrak{a} \), 于是 \( h(a_1, \ldots, a_n) =
  0 \), 最后一个方程变成 \( 1 = 0 \), 这是不可能的.
  因此, 由\cref{theorem-Nullstellensatz}, \( (g_1, \ldots, g_m, 1 - Yh) = k[X_1,
  \ldots, X_n, Y] \).
  换句话说, 存在 \( f_i \in k[X_1, \ldots, X_n, Y] \) 使得
  \[
    1 = \sum_{i = 1}^mf_i g_i + f_{m + 1}(1 - Yh).
  \]
  考虑态射
  \[
    k[X_1, \ldots, X_n, Y] \to k(X_1, \ldots, X_n),\quad X_i \mapsto X_i, Y
    \mapsto h^{-1},
  \]
  其将 \( \sum_{i = 1}^mf_i g_i + f_{m + 1}(1 - Yh) \) 映到
  \[
    1 = \sum_i f_i(X_1, \ldots, X_n, h^{-1})g_i(X_1, \ldots, X_n).
  \]
  对足够大的 \( N \), 两边乘以 \( h^N \) 知道 \( h^N \in \mathfrak{a} \).
\end{proof}

\begin{proposition}
  \label{proposition-radical-as-maximal-intersection-in-finite-generated-algebra-over-field}
  假设 \( A \) 是一个有限生成 \( k \)-代数, \( \mathfrak{a} \) 为 \( A \)
  的理想.
  那么
  \[
    \operatorname{rad}(\mathfrak{a}) = \bigcap_{\mathfrak{m} \supseteq
    \mathfrak{a} \text{极大}} \mathfrak{m}.
  \]
  特别地, 如果 \( A \) 约化, 那么 \( \bigcap_{\mathfrak{m} \text{极大}}
  \mathfrak{m} = 0 \).
\end{proposition}
\begin{proof}
  只需对 \( A = k[X_1, \ldots, X_n] \) 的情况证明.
  由\cref{proposition-radical-as-prime-intersection}包含关系 \( \operatorname{rad}(\mathfrak{a}) \subseteq \bigcap_{\mathfrak{m}
  \supseteq \mathfrak{a}} \mathfrak{m} \) 是已知的.
  下面证明\( \operatorname{rad}(\mathfrak{a}) \subseteq \bigcap_{\mathfrak{m}
  \supseteq \mathfrak{a}} \mathfrak{m} \).

  \cref{theorem-Nullstellensatz} 保证了 \( Z(\mathfrak{a}) \neq \varnothing \),
  取任意 \( (a_1, \ldots, a_n) \in Z(\mathfrak{a}) \).
  假设 \( h \in \bigcap_{\mathfrak{m} \supseteq \mathfrak{a}} \mathfrak{m} \),
  考虑赋值映射
  \[
    \operatorname{ev}: k[X_1, \ldots, X_n] \to \overline{k},\quad f \mapsto f(a_1, \ldots, a_n),
  \]
  其中 \( \overline{k} \) 为 \( k \) 的代数闭包.
  \( \operatorname{Im} \operatorname{ev} \) 在 \( k \) 上代数, \(
  \operatorname{Im} \operatorname{ev} \) 是一个域.
  因此 \( \operatorname{ker} \operatorname{ev} \) 是一个包含 \( \mathfrak{a} \)
  的极大理想.
  由 \( h \) 定义, \( h \in \operatorname{ker} \operatorname{ev} \), 换句话说 \(
  h(a_1, \ldots, a_n) = 0 \).
  由\cref{theorem-strong-Nullstellensatz} \( h \in
  \operatorname{rad}(\mathfrak{a}) \).
\end{proof}

\section{有向极限与逆极限}

\subsection{基本定义以及构造}

\paragraph{有向极限} 给定一个预序集范畴 \( (I, \leq) \), 给定范畴 \( \mathcal{M}
\) 其对象集是模 \( (M_i)_{i \in I} \), 态射集为 \( \left\lbrace \alpha^i_j: M_i
\to M_j: i \leq j \right\rbrace \), 我们称模 \( \varinjlim M_k \) 为逗号范畴 \(
(\alpha / \Delta) := (j_\alpha / \Delta) \)
\[
  \mathbf{1} \xrightarrow{\alpha} \mathcal{M}^I = \operatorname{Fct}(I,
  \mathcal{M}) \xleftarrow{\Delta} \mathcal{M}
\]
的始对象为 \emph{有向极限}, 其中 \( \mathbf{1} \)
为恰有一个对象和一个态射的范畴, \( \alpha \) 为函子 \( 1 \mapsto \left( (i
\mapsto j) \mapsto (M_i \to M_j) \right) \) , \( \Delta \)
为\href{https://en.wikipedia.org/wiki/Diagonal_functor}{对角函子}. 换句话说, \(
\varinjlim M_k \) 满足下面的交换图.
% https://q.uiver.app/#q=WzAsNCxbMCwwLCJNX2kiXSxbMiwwLCJNX2oiXSxbMSwxLCJcXHZhcmluamxpbSBNX2siXSxbMSwyLCJOIl0sWzAsMywiXFxiZXRhX2kiLDJdLFswLDEsIlxcYWxwaGFeaV9qIl0sWzAsMiwiXFxhbHBoYV9pIl0sWzEsMiwiXFxhbHBoYV9qIiwyXSxbMSwzLCJcXGJldGFfaiJdLFsyLDMsIlxcZXhpc3RzISIsMSx7InN0eWxlIjp7ImJvZHkiOnsibmFtZSI6ImRhc2hlZCJ9fX1dXQ==
\[\begin{tikzcd}
	{M_i} && {M_j} \\
	& {\varinjlim M_k} \\
	& N
	\arrow["{\alpha^i_j}", from=1-1, to=1-3]
	\arrow["{\alpha_i}", from=1-1, to=2-2]
	\arrow["{\beta_i}"', from=1-1, to=3-2]
	\arrow["{\alpha_j}"', from=1-3, to=2-2]
	\arrow["{\beta_j}", from=1-3, to=3-2]
	\arrow["{\exists!}"{description}, dashed, from=2-2, to=3-2]
\end{tikzcd}\]

\paragraph{有向极限的构造} 考察 \( M_i \) 的直积 \( \bigoplus_{i \in I} M_i \),
那么可以将 \( M_{i_0} \) 视为 \( \bigoplus_{i \in I} M_i \) 的子模, 后者对所有
\( i \neq i_0 \) 都满足 \( m_i = 0 \). 取 \( M \) 为 \( \bigoplus_{i \in I}
M_i \) 商去元素
\[
  m_i - \alpha^i_j(m_i),\quad m_i \in M_i,\quad i < j
\]
生成的子模即为所求.

\paragraph{逆极限}
类似地, 沿用上面的 \( I \), \( \mathcal{M} \) 对象集为 \( (M_i)_{i \in I} \),
态射集 \( \left\lbrace p^i_j: M_j \to M_i: i \leq j \right\rbrace \), 我们称模
\( \varprojlim M_k \) 为逗号范畴 \( (\Delta / \beta) := (\Delta / j_\beta) \)
\[
  \mathcal{M} \xrightarrow{\Delta} \mathcal{M}^{I^{\operatorname{op}}}
  \xleftarrow{j_\beta} \mathbf{1}
\]
的终对象为 \emph{逆极限}. 换句话说, \( \varprojlim M_k \) 满足下面交换图.
% https://q.uiver.app/#q=WzAsNCxbMCwwLCJNX2kiXSxbMiwwLCJNX2oiXSxbMSwxLCJcXHZhcnByb2psaW0gTV9rIl0sWzEsMiwiTiJdLFszLDIsIlxcZXhpc3RzISIsMSx7InN0eWxlIjp7ImJvZHkiOnsibmFtZSI6ImRhc2hlZCJ9fX1dLFszLDFdLFszLDBdLFsxLDAsInBeaV9qIiwyXSxbMiwwLCJwX2kiLDJdLFsyLDEsInBfaiJdXQ==
\[\begin{tikzcd}
	{M_i} && {M_j} \\
	& {\varprojlim M_k} \\
	& N
	\arrow["{p^i_j}"', from=1-3, to=1-1]
	\arrow["{p_i}"', from=2-2, to=1-1]
	\arrow["{p_j}", from=2-2, to=1-3]
	\arrow[from=3-2, to=1-1]
	\arrow[from=3-2, to=1-3]
	\arrow["{\exists!}"{description}, dashed, from=3-2, to=2-2]
\end{tikzcd}\]
特别地, 我们常取 \( I = \mathbb{N} \).

\paragraph{逆极限的构造} 给定义 \( A \)-模逆向系统 \( (M_n, \alpha_n) \),
我们定义 \( \varprojlim M_n \) 和 \( \varprojlim^1 M_n \) 为 \( A
\)-模同态的核与余核
\[
  \prod M_n \to \prod M_n,\quad (\ldots, m_n, \ldots) \mapsto (\ldots, m_n -
  \alpha_n(m_{n + 1}), \ldots)
\]

\subsection{基本性质}

\begin{proposition}
  对环 \( A \) 的每个乘性子集 \( S \), 有 \( S^{-1} A \simeq \varinjlim A_h \),
  其中 \( h \) 跑遍 \( S \), 偏序关系为整除关系.
\end{proposition}
\begin{proof}
  如果在 \( A \) 中有 \( h' = hq \), 那么 \( h \) 在 \( A_{h'} \) 中为单位,
  由局部化的泛性质存在唯一的同态 \( A_h \to A_{h'},\quad \frac{a}{h} \mapsto
  \frac{aq}{h'} \), 由此可以构造 \( \varinjlim A_h \). 又由有自然的 \( A_h \to
  S^{-1} A \) 以及有向极限的泛性质知道存在 \( \varinjlim A_h \to S^{-1}A \).
  又由有向极限的构造知道存在 \( S^{-1} A \to \varinjlim A_h \).
  对比这两个箭头知道, 它们互逆.
\end{proof}

\begin{proposition}
  假设 \( \left(M_i, \alpha^i_j\right), \left(N_i, \beta^i_j\right) \) 和 \(
  \left(P_i, \gamma^i_j\right) \) 为相对于有序集 \( I \) 的有向系统, 令
  \[
    \left(M_i, \alpha^i_j\right) \xrightarrow{(a_i)} \left(N_i, \beta^i_j\right)
    \xrightarrow{(b_i)} \left(P_i, \gamma^i_j\right)
  \]
  为有向系统列. 如果列
  \[
    M_i \xrightarrow{a_i} N_i \xrightarrow{b_i} P_i
  \]
  对所有 \( i \) 均正合, 那么
  \[
    \varinjlim M_i \xrightarrow{\varinjlim a_i} \varinjlim N_i
    \xrightarrow{\varinjlim b_i} \varinjlim P_i
  \]
  正合.
\end{proposition}
\begin{proof}
  %TODO: 完成此证明.
\end{proof}

\begin{proposition}
  假设对每个逆向系统 \( (M_n, \alpha_n) \) 和 \( A \)-模 \( N \)
  \[
    \operatorname{Hom}(\varprojlim M_n, N) \simeq \varprojlim
    \operatorname{Hom}(M_n, N)
  \]
\end{proposition}
\begin{proof}
  函子 \( \operatorname{Hom}(\bullet, N) \) 将逆向系统 \( (M_n, \alpha_n) \)
  映到逆向系统 \( \left(\operatorname{Hom}(M_n, N), (\alpha_n)_*\right) \). 映射
  \( \varprojlim M_n \to M_i \) 诱导了 \( \operatorname{Hom}(\varprojlim M_n, N)
  \to \operatorname{Hom}(M_i, N) \), 进而由逆极限的泛性质, 有态射
  \[
    \operatorname{Hom}(\varprojlim M_n, N) \to \varprojlim
    \operatorname{Hom}(M_n, N)
  \]
  反过来, 取 \( (f_i) \in \varprojlim \operatorname{Hom}(M_n, N) \), 取 \(
  (m_i) \in \varprojlim M_n \), \( (f_i) \) 诱导了 \( (m_i) \mapsto f_1(m_1) \).
  验证两者互逆即可.
\end{proof}

\begin{proposition}
  逆向系统列
  \[
    0 \to (M_n, \alpha_n) \to (N_n, \beta_n) \to (P_n, \gamma_n) \to 0
  \]
  诱导了正合列
  \[
    0 \to \varprojlim M_n \to \varprojlim N_n \to \varprojlim P_n \to
    \varprojlim\nolimits^1 M_n \to \varprojlim\nolimits^1 N_n \to
    \varprojlim\nolimits^1 P_n \to 0
  \]
\end{proposition}
\begin{proof}
  考察
  % https://q.uiver.app/#q=WzAsMTQsWzAsMiwiMCJdLFsxLDIsIlxccHJvZCBNX24iXSxbMSwxLCJcXHByb2QgTV9uIl0sWzIsMSwiXFxwcm9kIE5fbiJdLFsyLDIsIlxccHJvZCBOX24iXSxbMywxLCJcXHByb2QgUF9uIl0sWzMsMiwiXFxwcm9kIFBfbiJdLFs0LDEsIjAiXSxbMSwwLCJcXHZhcnByb2psaW0gTV9uIl0sWzEsMywiXFx2YXJwcm9qbGltXjEgTV9uIl0sWzIsMywiXFx2YXJwcm9qbGltXjEgTl9uIl0sWzMsMywiXFx2YXJwcm9qbGltXjEgTl9uIl0sWzIsMCwiXFx2YXJwcm9qbGltIE5fbiJdLFszLDAsIlxcdmFycHJvamxpbSBQX24iXSxbMCwxXSxbMiwxXSxbMiwzXSxbMSw0XSxbMyw0XSxbMyw1XSxbNCw2XSxbNSw2XSxbNSw3XSxbOCwyXSxbMTIsM10sWzEzLDVdLFs4LDEyLCIiLDEseyJzdHlsZSI6eyJib2R5Ijp7Im5hbWUiOiJkYXNoZWQifX19XSxbMTIsMTMsIiIsMSx7InN0eWxlIjp7ImJvZHkiOnsibmFtZSI6ImRhc2hlZCJ9fX1dLFs5LDEwLCIiLDEseyJzdHlsZSI6eyJib2R5Ijp7Im5hbWUiOiJkYXNoZWQifX19XSxbMTAsMTEsIiIsMSx7InN0eWxlIjp7ImJvZHkiOnsibmFtZSI6ImRhc2hlZCJ9fX1dLFsxMyw5LCIiLDEseyJzdHlsZSI6eyJib2R5Ijp7Im5hbWUiOiJkYXNoZWQifX19XSxbMSw5XSxbNCwxMF0sWzYsMTFdXQ==
  \[\begin{tikzcd}
    & {\varprojlim M_n} & {\varprojlim N_n} & {\varprojlim P_n} \\
    & {\prod M_n} & {\prod N_n} & {\prod P_n} & 0 \\
    0 & {\prod M_n} & {\prod N_n} & {\prod P_n} \\
    & {\varprojlim^1 M_n} & {\varprojlim^1 N_n} & {\varprojlim^1 N_n}
    \arrow[dashed, from=1-2, to=1-3]
    \arrow[from=1-2, to=2-2]
    \arrow[dashed, from=1-3, to=1-4]
    \arrow[from=1-3, to=2-3]
    \arrow[from=1-4, to=2-4]
    \arrow[dashed, from=1-4, to=4-2]
    \arrow[from=2-2, to=2-3]
    \arrow[from=2-2, to=3-2]
    \arrow[from=2-3, to=2-4]
    \arrow[from=2-3, to=3-3]
    \arrow[from=2-4, to=2-5]
    \arrow[from=2-4, to=3-4]
    \arrow[from=3-1, to=3-2]
    \arrow[from=3-2, to=3-3]
    \arrow[from=3-2, to=4-2]
    \arrow[from=3-3, to=3-4]
    \arrow[from=3-3, to=4-3]
    \arrow[from=3-4, to=4-4]
    \arrow[dashed, from=4-2, to=4-3]
    \arrow[dashed, from=4-3, to=4-4]
  \end{tikzcd}\]
  利用 \href{https://en.wikipedia.org/wiki/Snake_lemma}{蛇形引理} 即可.
\end{proof}

\begin{corollary}
  如果映射 \( \alpha_n: M_{n + 1} \to M_n \) 都是满射的, 那么 \( \varprojlim^1
  M_n = 0 \).
\end{corollary}
\begin{proof}
  %TODO: 证明.
\end{proof}

\section{张量积}

\paragraph{张量积} 假设 \( A \) 是一个环, \( M, N \) 和 \( P \) 都是 \( A \)-模.
态射 \( \phi: M \times N \to P \) 称为 \emph{\( A \)-模双线性}, 如果
\[
  \begin{aligned}
    &\phi(x + x', y) = \phi(x, y) + \phi(x', y),     &x, x' \in M,& y \in N\\
    &\phi(x, y + y') = \phi(x, y) + \phi(x, y + y'), &x \in M,& y, y' \in N\\
    &\phi(ax, y) = a \phi(x, y), &a \in A, &x \in M, &y \in N\\
    &\phi(x, ay) = a \phi(x, y), &a \in A, &x \in M, &y \in N.
  \end{aligned}
\]
一个 \( A \)-模 \( T \) 带 \( A \)-模双线性映射
\[
  \phi: M \times N \to T
\]
称为 \emph{\( M \) 和 \( N \) 的张量积}, 如果它由下述泛性质: 对每个 \( A
\)-双线性映射
\[
  \phi': M \times N \to T'
\]
能被 \( \phi \) 唯一分解.
% https://q.uiver.app/#q=WzAsMyxbMCwwLCJNIFxcdGltZXMgTiJdLFsxLDAsIlQiXSxbMSwxLCJUJyJdLFswLDIsIlxccGhpJyIsMl0sWzAsMSwiXFxwaGkiXSxbMSwyLCJcXGV4aXN0cyAhIFxcdGV4dHvnur/mgKd9IiwwLHsic3R5bGUiOnsiYm9keSI6eyJuYW1lIjoiZGFzaGVkIn19fV1d
\[\begin{tikzcd}
	{M \times N} & T \\
	& {T'}
	\arrow["\phi", from=1-1, to=1-2]
	\arrow["{\phi'}"', from=1-1, to=2-2]
	\arrow["{\exists ! \text{线性}}", dashed, from=1-2, to=2-2]
\end{tikzcd}\]
我们将其记作 \( M \otimes_A N \), 注意到
\[
  \operatorname{Hom}_{A \text{线性}} (M \times N, T) \simeq
  \operatorname{Hom}_{A \text{线性}} (M \otimes_A N, T).
\]

\paragraph{张量积的构造} 假设 \( M \) 和 \( N \) 为 \( A \)-模, 令 \( A^{(M
\times N)} \) 为自由 \( A \)-模, 其基为 \( M \times N \), 因此每个 \( A^{(M
\times N)} \) 可以唯一表示为有限和
\[
  \sum a_i (x_i, y_i),\quad a_i \in A,\quad x_i \in M,\quad y_i \in N.
\]
假设 \( A^{(M \times N)} \) 的子模 \( P \) 由
\[
  \begin{aligned}
    &(x + x', y) - (x, y) - (x', y), &x, x' \in M, &y \in N\\
    &(x, y + y') - (x, y) - (x, y'), &x \in M, &y, y' \in N\\
    &(ax, y) - a(x, y), &a \in A, &x \in M, &y \in N\\
    &(x, ay) - a(x, y), &a \in A, &x \in M, &y \in N.
  \end{aligned}
\]
\( A^{(M \times N)} / P \) 即为 \( M \otimes_A N \).

\subsection{基本性质}

\begin{proposition}
  假设 \( M, N, P \) 为 \( A \)-模.
  \begin{enumerate}
    \item 存在唯一的同构
      \[
        \lambda: A \otimes M \to M
      \]
      对所有 \( a \in A, m \in M \) 有 \( \lambda(a \otimes m) = am  \).
    \item 存在唯一的同构
      \[
        \alpha: M \otimes (N \otimes P) \to (M \otimes N) \otimes P
      \]
      对所有 \( m \in M, n \in N, p \in P \) 有 \( \alpha(m \otimes (n \otimes
      p)) = (m \otimes n) \otimes p \).
    \item 存在唯一的同构
      \[
        \gamma: M \otimes N \to N \otimes M
      \]
      对所有 \( m \in M, n \in N \) 有 \( \gamma(m \otimes N) = n \otimes m \).
  \end{enumerate}
\end{proposition}

\paragraph{标量扩张} 假设 \( A \) 为交换环, \( B \) 为一个(未必交换的) \( A
\)-代数, 使得 \( A \to B \) 结构同态的像落于 \( B \) 的中心里. 因此
\[
  M \leadsto B \otimes_A M
\]
是一个左 \( A \)-模到左 \( B \)-模的函子. 假设 \( M \) 为 \( A \)-模, \( N \) 为
\( B \)-模, 那么
\[
  \begin{aligned}
    \operatorname{Hom}_{A-\text{线性}} (M, N) &\simeq
    \operatorname{Hom}_{B-\text{线性}} (B \otimes_A M, N)\\ \alpha &\mapsto
    \left(b \otimes m \mapsto b \cdot \alpha(m)\right)\\ \beta \circ \iota
    &\mapsfrom \beta.
  \end{aligned}
\]
如果 \( (e_{\alpha})_{\alpha \in I} \) 是 \( A \)-模 \( M \) 的一族生成元, 那么
\( (1 \otimes e_{\alpha})_{\alpha \in I} \) 为 \( B \)-模 \( B \otimes_A M \)
的一组生成元.

函子 \( M \leadsto M_B := B \otimes_A M \) 与张量积交换
\[
  (M \otimes_A N)_B \simeq M_B \otimes_B N_B.
\]
这是因为 %TODO: 证明结合律
\begin{align*}
  M_B &= (B \otimes_A M) \otimes_B (B \otimes_A N)\\ &\simeq((B \otimes_A M)
  \otimes_B B) \otimes_A N\\ &\simeq(B \otimes_A M) \otimes_A N\\ &\simeq B
  \otimes_A (M \otimes_A N) \\ &\simeq (M \otimes_A N)_B.
\end{align*}

\paragraph{有向极限}
\begin{proposition}
  有向极限和张量积是交换的
  \[
    \varinjlim_{i \in I} M_i \otimes_A \varinjlim_{j \in J} N_j \simeq
    \varinjlim_{(i, j) \in I \times J} M_i \otimes_A N_j.
  \]
\end{proposition}
\begin{proof}
  %TODO: 完成此证明
  % 由张量积的泛性质, \( \left((m_i), (n_j)\right) \mapsto \left(m_i \otimes_A
  % n_j \right) \) 诱导了 \( (m_i) \otimes_A (n_j) \mapsto \left(m_i \otimes_A
  % n_j \right) \). 反过来, 在由张量积的泛性质 \( (m_i, n_j) \mapsto m_i
  % \otimes_A n_j \), 其中
\end{proof}

\subsection{代数张量积, 张量代数以及对称代数}
\paragraph{代数张量积} 假设 \( k \) 是一个环, \( A \) 和 \( B \) 为 \( k
\)-代数. 我们称 \( k \) 代数 \( C \) 和同态 \( i: A \to C \) 和 \( j: B \to C \)
称为 \emph{\( A \) 和 \( B \) 的张量积}, 如果其满足下述泛性质: 对每一对 \( k
\)-代数同态 \( f: A \to R \) 和 \( g: B \to R \), 存在唯一的同态 \( (f, g): C
\to R \) 使得 \( (f, g) \circ i = \alpha \) 和 \( (f, g) \circ j = \beta \).
% https://q.uiver.app/#q=WzAsNCxbMCwwLCJBIl0sWzEsMCwiQyJdLFsxLDEsIlIiXSxbMiwwLCJCIl0sWzMsMiwiZyJdLFswLDIsImYiLDJdLFswLDEsImkiXSxbMywxLCJqIiwyXSxbMSwyLCJcXGV4aXN0cyAhIChmLCBnKSIsMSx7InN0eWxlIjp7ImJvZHkiOnsibmFtZSI6ImRhc2hlZCJ9fX1dXQ==
\[\begin{tikzcd}
	A & C & B \\
	& R
	\arrow["i", from=1-1, to=1-2]
	\arrow["f"', from=1-1, to=2-2]
	\arrow["{\exists ! (f, g)}"{description}, dashed, from=1-2, to=2-2]
	\arrow["j"', from=1-3, to=1-2]
	\arrow["g", from=1-3, to=2-2]
\end{tikzcd}\]
其同构意义上是唯一的, 记作 \( A \otimes_k B \). 这个泛性质告诉我们
\[
  \operatorname{Hom}(A \otimes_k B, R) \simeq \operatorname{Hom}(A, R) \times
  \operatorname{Hom}(B, R).
\]

\paragraph{张量积的构造} 首先将 \( A \) 和 \( B \) 视为 \( k \)-模,
形成了模张量积 \( A \otimes_k B \), 那么存在乘法 \( A \otimes_k B \times A
\otimes_k B \to A \otimes_k B \) 使得
\[
  (a \otimes b)(a' \otimes b') = a a' \otimes aa' \otimes aa',\quad a, a \in
  A,\quad b, b' \in B.
\]
这使得 \( A \otimes_k B \) 成为一个环, 态射
\[
  c \mapsto c (1 \otimes 1) = c \otimes 1 = 1 \otimes c
\]
使得其变为一个 \( k \)-代数. 映射 \( i, j \) 构造如下.
\[
  i: A \to A \otimes_k B, a \mapsto a \otimes 1 \text{ 和 } j: B \to A \otimes_k
  B \to B, b \mapsto 1 \otimes b
\]

\paragraph{张量代数} 假设 \( M \) 是 \( A \)-模. 对每一个 \( A \neq 0 \), 置
\[
  T^r M = \underbrace{M \otimes_A \cdots \otimes_A M}_{r \text{个}}
\]
特别地, \( T^0 M = A \) 以及 \( T^1 M = M \). 定义
\[
  TM = \bigoplus_{r \geq 0} T^r M.
\]
这个模可以赋予一个非交换 \( A \)-代数, 称为 \emph{\( M \) 的张量代数},
其乘法如:
\begin{align*}
  T^r M \times T^s M &\to T^{r + s}M\\ (m_1 \otimes \cdots \otimes m_r, m_{r +
  1} \otimes \cdots \otimes m_{r + s}) &\mapsto m_1 \otimes \cdots \otimes m_{r
  + s}.
\end{align*}
对 \( (TM, M \to TM) \) 由下述泛性质: 由 \( M \) 到(未必交换的) \( A \)-代数 \(
R \) 的 \( A \)-线性映射能唯一分解为 \( A \)-代数同态 \( TM \to R \).
% https://q.uiver.app/#q=WzAsMyxbMCwwLCJNIl0sWzEsMCwiVE0iXSxbMSwxLCJSIl0sWzAsMiwiQVxcdGV4dHst57q/5oCnfSIsMl0sWzAsMV0sWzEsMiwiXFxleGlzdHMhQVxcdGV4dHst5Luj5pWwfSIsMCx7InN0eWxlIjp7ImJvZHkiOnsibmFtZSI6ImRhc2hlZCJ9fX1dXQ==
\[\begin{tikzcd}
	M & TM \\
	& R
	\arrow[from=1-1, to=1-2]
	\arrow["{A\text{-线性}}"', from=1-1, to=2-2]
	\arrow["{\exists!A\text{-代数}}", dashed, from=1-2, to=2-2]
\end{tikzcd}\]
如果 \( M \) 是一个基为 \( x_1, \ldots, x_n \) 自由 \( A \)-模, 那么 \( TM \)
是一个 \( A \) 的非交换记号 \( x_i \) 上的非交换多项式环.

\paragraph{对称代数} 一个 \( A \)-模 \( M \) 称为 \emph{对称代数 \(
\operatorname{Sym}(M) \)} 为 \( TM \) 商去由下面 \( T^2 M \) 元素生成的理想
\[
  m \otimes n - n \otimes m, \quad m, n \in M.
\]
这是分次代数 \( \operatorname{Sym}(M) = \bigoplus_{r \geq 0}
\operatorname{Sym}^r (M) \), 其中 \( \operatorname{Sym}^{r}(M) \) 为 \(
M^{\otimes r} \) 商去下面元素生成的理想
\[
  m_1 \otimes \cdots \otimes m_r - m_{\sigma(1)} \otimes \cdots \otimes
  m_{\sigma(r)},\quad m_i \in M,\quad \sigma \in \operatorname{Sym}(r)
\]
对 \( (\operatorname{Sym}(M), M \to \operatorname{Sym}(M)) \) 有下述泛性质:
对每个由 \( M \) 到一个交换的 \( A \)-代数 \( M \) 的 \( A \)-线性映射 \( M \to
R \) 能唯一分解为 \( A \)-代数同态 \( \operatorname{Sym}(M) \to R \).
% https://q.uiver.app/#q=WzAsMyxbMCwwLCJNIl0sWzEsMCwiXFxvcGVyYXRvcm5hbWV7U3ltfShNKSJdLFsxLDEsIlIiXSxbMCwyLCJBXFx0ZXh0ey3nur/mgKd9IiwyXSxbMCwxXSxbMSwyLCJcXGV4aXN0cyFBXFx0ZXh0ey3ku6PmlbB9IiwwLHsic3R5bGUiOnsiYm9keSI6eyJuYW1lIjoiZGFzaGVkIn19fV1d
\[\begin{tikzcd}
	M & {\operatorname{Sym}(M)} \\
	& R
	\arrow[from=1-1, to=1-2]
	\arrow["{A\text{-线性}}"', from=1-1, to=2-2]
	\arrow["{\exists!A\text{-代数}}", dashed, from=1-2, to=2-2]
\end{tikzcd}\]
如果 \( M \) 是一个基为 \( x_1, \ldots, x_n \) 自由 \( A \)-模, 那么 \(
\operatorname{Sym}M \) 是一个 \( A \) 的交换记号 \( x_i \) 上的交换多项式环.

\section{平坦性}
\begin{proposition}
  如果 \( M \) 是一个 \( A \)-模, \( 0 \to N' \xrightarrow{\alpha} N
  \xrightarrow{\beta} N'' \to 0 \) 是一个正合的 \( A \)-模列, 那么列
  \[
    M \otimes_A N' \xrightarrow{1 \otimes \alpha} M \otimes_A N \xrightarrow{1
    \otimes \beta} M \otimes_A N'' \to 0
  \]
  正合.
\end{proposition}
\begin{proof}
  %TODO: 证明
\end{proof}

\subsection{平坦与忠实平坦}

\begin{example}
  单射 \( N \to N' \) 诱导的映射 \( M \otimes_A N' \to M \otimes_A N \)
  \textbf{未必}是单射. 考虑正合列
  \[
    0 \to \mathbb{Z} \xrightarrow{\times m} \mathbb{Z} \to \mathbb{Z} / m
    \mathbb{Z} \to 0.
  \]
  函子 \( \bullet \otimes_{\mathbb{Z}} \mathbb{Z} / m \mathbb{Z} \) 下
  \( \mathbb{Z} / m \mathbb{Z} \xrightarrow{x \mapsto mx = 0} \mathbb{Z} / m
  \mathbb{Z} \) 为零态射, 并非单射.
\end{example}

\begin{example}
  \( M \) 和 \( N \) 均非零时, \( M \otimes_A N \) \textbf{未必} 非零. 例如
  \[
    \mathbb{Z} / 2 \mathbb{Z} \otimes_{\mathbb{Z}} \mathbb{Z} / 3 \mathbb{Z} =
    0,
  \]
  因此 \( a \otimes b = (3 - 2) a \otimes b = -2a \otimes b + a \otimes 3b = 0
  \). 实际上, 更特别地, \( M = N \neq 0 \) 时 \( M \otimes_A N \) 亦有可能为零,
  例如
  \[
    \mathbb{Q} / \mathbb{Z} \otimes_{\mathbb{Z}} \mathbb{Q} / \mathbb{Z} = 0.
  \]
\end{example}

一个 \( A \)-模 \( M \) 称为
\begin{enumerate}
  \item \emph{平坦}, 如果对任意 \( A \)-模 \( N, N' \)
    \[
      N' \to N \text{单} \implies M \otimes_A N' \to M \otimes_A N \text{单}.
    \]
  \item \emph{忠实平坦}, 如果对任意 \( A \)-模 \( N \)
    \[
      M \otimes_A N = 0 \implies N = 0.
    \]
\end{enumerate}
一个环同态 \( A \to B \) 称为\emph{平坦}(resp. \emph{忠实平坦}), 如果 \( B \)
作为 \( A \)-模平坦(resp. 忠实平坦).
\begin{remark}
  正合函子保长正合性, 这是因为正合列
% https://q.uiver.app/#q=WzAsMTMsWzIsMiwiQSciXSxbMywzLCJcXG9wZXJhdG9ybmFtZXtJbX1mIl0sWzEsMSwiXFxvcGVyYXRvcm5hbWV7S2VyfWYiXSxbMCwwLCIwIl0sWzQsNCwiMCJdLFsyLDQsIjAiXSxbNCwyLCJBIl0sWzYsMiwiQScnIl0sWzUsMSwiXFxvcGVyYXRvcm5hbWV7SW19IGciXSxbNiwwLCIwIl0sWzcsMywiXFxvcGVyYXRvcm5hbWV7Q29rZXJ9ZyJdLFs4LDQsIjAiXSxbNCwwLCIwIl0sWzMsMl0sWzIsMF0sWzAsMV0sWzUsMV0sWzEsNF0sWzEsNl0sWzAsNiwiZiJdLFs2LDcsImciXSxbNiw4XSxbOCw5XSxbOCw3XSxbNywxMF0sWzEwLDExXSxbMTIsOF1d
\[\begin{tikzcd}[sep=tiny]
	0 &&&& 0 && 0 \\
	& {\operatorname{Ker}f} &&&& {\operatorname{Im} g} \\
	&& {A'} && A && {A''} \\
	&&& {\operatorname{Im}f} &&&& {\operatorname{Coker}g} \\
	&& 0 && 0 &&&& 0
	\arrow[from=1-1, to=2-2]
	\arrow[from=1-5, to=2-6]
	\arrow[from=2-2, to=3-3]
	\arrow[from=2-6, to=1-7]
	\arrow[from=2-6, to=3-7]
	\arrow["f", from=3-3, to=3-5]
	\arrow[from=3-3, to=4-4]
	\arrow[from=3-5, to=2-6]
	\arrow["g", from=3-5, to=3-7]
	\arrow[from=3-7, to=4-8]
	\arrow[from=4-4, to=3-5]
	\arrow[from=4-4, to=5-5]
	\arrow[from=4-8, to=5-9]
	\arrow[from=5-3, to=4-4]
\end{tikzcd}\]
正合函子 \( F \) 诱导了交换图, % https://q.uiver.app/#q=WzAsMTMsWzIsMiwiRihBJykiXSxbMywzLCJGKFxcb3BlcmF0b3JuYW1le0ltfWYpIl0sWzEsMSwiRihcXG9wZXJhdG9ybmFtZXtLZXJ9ZikiXSxbMCwwLCIwIl0sWzQsNCwiMCJdLFsyLDQsIjAiXSxbNCwyLCJGKEEpIl0sWzYsMiwiRihBJycpIl0sWzUsMSwiRihcXG9wZXJhdG9ybmFtZXtJbX0gZykiXSxbNiwwLCIwIl0sWzcsMywiRihcXG9wZXJhdG9ybmFtZXtDb2tlcn1nKSJdLFs4LDQsIjAiXSxbNCwwLCIwIl0sWzMsMl0sWzIsMF0sWzAsMV0sWzUsMV0sWzEsNF0sWzEsNl0sWzAsNiwiRihmKSJdLFs2LDcsIkYoZykiXSxbNiw4XSxbOCw5XSxbOCw3XSxbNywxMF0sWzEwLDExXSxbMTIsOF1d
\[\begin{tikzcd}[sep=tiny]
	0 &&&& 0 && 0 \\
	& {F(\operatorname{Ker}f)} &&&& {F(\operatorname{Im} g)} \\
	&& {F(A')} && {F(A)} && {F(A'')} \\
	&&& {F(\operatorname{Im}f)} &&&& {F(\operatorname{Coker}g)} \\
	&& 0 && 0 &&&& 0
	\arrow[from=1-1, to=2-2]
	\arrow[from=1-5, to=2-6]
	\arrow[from=2-2, to=3-3]
	\arrow[from=2-6, to=1-7]
	\arrow[from=2-6, to=3-7]
	\arrow["{F(f)}", from=3-3, to=3-5]
	\arrow[from=3-3, to=4-4]
	\arrow[from=3-5, to=2-6]
	\arrow["{F(g)}", from=3-5, to=3-7]
	\arrow[from=3-7, to=4-8]
	\arrow[from=4-4, to=3-5]
	\arrow[from=4-4, to=5-5]
	\arrow[from=4-8, to=5-9]
	\arrow[from=5-3, to=4-4]
\end{tikzcd}\]
其中斜对角链都是正合的, 由交换性
\begin{align*}
  \operatorname{Im}F(f) &= \operatorname{Im} (F(A') \to F(\operatorname{Im}f) \to
  F(A))\\ &= \operatorname{Im} (F(\operatorname{Im}f) \to F(A)) \\ &=
  \operatorname{Ker} (F(A) \to F(\operatorname{Im}g)) \\ &=
  \operatorname{Ker}(F(A) \to F(\operatorname{Im}g) \to F(A'')) \\ &=
  \operatorname{Ker}F(g)
\end{align*}
第二个等号是因为 \( F(A') \to F(\operatorname{Im}f) \) 是满射, 第四个等号是因为
\( F(\operatorname{Im}g) \to F(A'') \) 是单射.
\end{remark}

\begin{proposition}
  假设 \( P \) 为忠实平坦 \( A \)-模. 那么 \( A \)-模链复形
  \[
    (N): \quad N' \xrightarrow{\alpha} N \xrightarrow{\beta} N''
  \]
  正合当且仅当
  \[
    P \otimes_A (N): \quad P \otimes_A N' \xrightarrow{1 \otimes \alpha} P
    \otimes_A N \xrightarrow{1 \otimes \beta} P \otimes_A N''
  \]
  正合.

  反过来, 如果
  \[
    (N) \text{正合} \iff P \otimes_A (N) \text{正合}
  \]
  那么 \( P \) 是一个忠实平坦 \( A \)-模.
\end{proposition}
\begin{proof}
  记 \( C = \operatorname{Ker} \beta / \operatorname{Im} \alpha \), 考虑正合列
  \[
    N' \xrightarrow{\alpha} \operatorname{Ker} (\beta) \to C \to 0
  \]
  如果 \( P \) 平坦, 可以验证 \( P \otimes_A \operatorname{Ker}\beta \simeq
  \operatorname{Ker}(1 \otimes \beta) \), 那么复形链
  \[
    P \otimes_A N' \xrightarrow{1 \otimes \alpha} \operatorname{Ker} (1 \otimes
    \beta) \to P \otimes_A C \to 0
  \]
  正合. 那么
  \[
    (N) \text{正合} \iff C = 0 \iff P \otimes_A C = 0 \iff P \otimes_A (N)
    \text{正合}.
  \]
\end{proof}

\begin{corollary}
  假设 \( A \to B \) 忠实平坦. 如果 \( M \otimes_A B \) 作为 \( B \)-模平坦
  (resp. 忠实平坦), 那么 \( A \)-模 \( M \) 平坦 (resp. 忠实平坦).
\end{corollary}
\begin{proof}
  考虑复形链 \( (N): N' \to N \to N'' \). 如果 \( M \otimes_A B \) 平坦, 那么
  \[
    (N) \text{正合} \iff B \otimes_A (N) \text{正合} \implies ((N) \otimes_A B)
    \otimes_B (M \otimes_A B) \text{正合},
  \]
  其中 \( ((N) \otimes_A B) \otimes_{B} (M \otimes_A B) \simeq ((N) \otimes_A
  M)\otimes_A B  \), 其正合当且仅当 \( (N) \otimes_A M \) 正合. 因此 \( M \)
  平坦. 如果 \( B \otimes_A M \) 忠实平坦, 那么 \( (N) \) 正合当且仅当 \( B
  \otimes_A M \) 正合, 从而 \( M \) 忠实平坦.
\end{proof}

\begin{corollary}
  假设 \( A \to B \) 忠实平坦, \( M \) 为 \( A \)-模. 如果 \( B \)-模 \( B
  \otimes_A M \) 有限生成, 那么 \( M \) 有限生成.
\end{corollary}
\begin{proof}
  假设 \( 1 \otimes m_1, \ldots, 1 \otimes m_r \) 生成 \( B \otimes_A M \), 记
  \( N \) 为由 \( m_i \) 生成的 \( M \)-子模. 那么正合列 \( N \to M \to M / N
  \to 0 \) 在张量 \( B \) 后保持正合. 而 \( B \otimes M / N = 0 \), 结合 \( B \)
  忠实平坦, 得到 \( M / N = 0 \).
\end{proof}

\begin{proposition}
  假设 \( i: A \to B \) 为忠实平坦同态. 对每个 \( A \)-模 \( M \), 列
  \[
    0 \to M \xrightarrow{d_0} B \otimes_A M \xrightarrow{d_1} B \otimes_A B
    \otimes_A M
  \]
  其中
  \[
    \begin{cases}
    d_0(m) = 1 \otimes m\\
    d_1(b \otimes m) = 1 \otimes b \otimes m - b \otimes 1 \otimes m
    \end{cases}
  \]
  正合.
\end{proposition}
\begin{proof}
  假设存在 \( i \) 的截面 \( f: B \to A \) 使得 \( f \circ i =
  \operatorname{id}_{A} \), 定义
  \begin{align*}
    &k_0: B \otimes_A M \to M,\quad k_0(b \otimes m) = f(b) m\\ &k_1: B
    \otimes_A B \otimes_A M \to B \otimes_A M,\quad k_1(b \otimes b' \otimes m)
    = f(b)b' \otimes m.
  \end{align*}
  那么 \( k_0 d_0 = \operatorname{id}_M \), 因此 \( d_0 \) 单. 此外,
  \[
    k_1 \circ d_1 + d_0 \circ k_0 = \operatorname{id}_{B \otimes_A M}
  \]
  这说明, 如果 \( d_1(x) = 0 \), 那么 \( x = d_0(k_0 (x)) \).

  一般地, 因为 \( A \to B \) 忠实平坦, 只需要证明欲证列张量 \( B \) 后是正合的,
  也就是
  \[
    0 \to B \otimes_A M \xrightarrow{1 \otimes d_0} B \otimes_A B \otimes_A M
    \xrightarrow{1 \otimes d_1} B \otimes_A B \otimes_A B \otimes_A M
  \]
  但 \( 1 \otimes d_0 \) 截面是容易构造的:
  \[
    f: B \otimes_A B \otimes_A M \to B \otimes_A M, b \otimes_A b' \otimes_A m
    \mapsto (bb') \otimes_A m.
  \]
\end{proof}

\begin{corollary}
  如果 \( A \to B \) 忠实平坦, 那么这个态射是单射, 且其像集为下面映射一致的元素.
  \[
    \begin{cases}
    b \mapsto 1 \otimes b\\
    b \mapsto b \otimes 1
    \end{cases}:\quad B \to B \otimes_A B.
  \]
\end{corollary}
\begin{proof}
  取 \( M = A \).
\end{proof}
