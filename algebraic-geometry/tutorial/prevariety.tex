\section{预簇}

\subsection{预簇与多项式环}

本节中, 我们假设 \( k \) 为一个代数闭域. 如果我们给定了多项式 \( f_1, \ldots,
f_r \in k[T_1, \ldots, T_n] \), 我们想要知道零点集
\[
  V(f_1, \ldots, f_r) = \left\lbrace (t_1, \ldots, t_n) \in k^n: f_i(t_1,
  \ldots, t_n) = 0, \forall i \right\rbrace \subseteq k^n
\]
的代数性质. 更一般地, 如果给定子集 \( M \subseteq k[T_1, \ldots, T_n] ] =
k[\mathbf{T}] \), 那么我们记  \emph{\( M \) 的公共零点集} 为
\[
  V(M) = \left\lbrace (t_1, \ldots, t_n) \in k^n; f(t_1, \ldots, t_n) = 0,
  \forall f \in M \right\rbrace
\]
特别地, 如果 \( M \) 由元素 \( f_i, i \in I \) 组成, 那么我们记 \( V(f_i, i \in
I) \) 而非 \( V(\left\lbrace f_i: i \in I \right\rbrace) \).

\begin{proposition}
  \label{proposition-Zariski-topology-construction}
  将所有形如\( V(\mathbf{a}) \) 的集合作为闭集构成了 \( k^n \) 的一个拓扑, 其中
  \( \mathbf{a} \) 跑遍 \( k[\mathbf{T}] \) 的理想. 这样的拓扑我们称为
  \emph{Zariski 拓扑}.
\end{proposition}

我们记 \( k^n \) 赋予 Zariski 拓扑的空间为 \( \mathbb{A}^n(k) \) 以示区别.
我们称 \( \mathbb{A}^n(k) \) 的闭集为 \emph{仿射代数集}. 我们可以完整地刻画 \(
\mathbb{A}^1(k) \) 以及 \( \mathbb{A}^2(k) \) 的闭集.

\begin{example}
  假设 \( n = 1 \). 由于此时 \( k[\mathbf{T}] \) 是主理想整环, \(
  \mathbb{A}^1(k) \) 的闭集要么是 \( \mathbb{A}^1(k) \) 本身, 要么是 \(
  \mathbb{A}^1(k) \) 的有限子集.
\end{example}

\begin{example}
  假设 \( n = 3 \). 这时 \( \mathbb{A}^2(k) \) 的闭集形如
  \begin{itemize}
    \item \( \mathbb{A}^2(k) \).
    \item 单点集.
    \item \( V(f) \), 其中 \( f \) 是不可约多项式.
  \end{itemize}
\end{example}

取定一点 \( \mathbf{x} = (x_1, x_2, \ldots, x_n) \in \mathbb{A}^n(k) \), 容易知道理想
\[
  (T_1 - x_1, T_2 - x_2, \ldots, T_n - x_n) \subseteq k[\mathbf{T}]
\]
是极大理想, 我们将其记作 \( \mathfrak{m}_{\mathbf{x}} \).
如果 \( Z \subseteq \mathbb{A}^n(k) \) 是一个子集, 我们记理想
\[
  I(Z) := \left\lbrace f \in k[\mathbf{T}]: f(x) = 0, \forall x \in Z
  \right\rbrace
\]
如果 \( f \in k[\mathbf{T}] \) 且 \( \mathbf{x} \in \mathbb{A}^n(k) \),
那么直接验证知道
\[
  f(x) = 0 \iff f \in \mathfrak{m}_{\mathbf{x}}.
\]
因此我们能给出进一步地刻画
\[
  I(Z) = \bigcap_{x \in Z}\mathfrak{m}_{\mathbf{x}}.
\]

\begin{proposition}
  \begin{enumerate}
    \item 如果 \( \mathfrak{a} \subseteq k[\mathbf{T}] \) 为一个理想, 那么
      \[
        I(V(\mathfrak{a})) = \operatorname{rad} \mathfrak{a}.
      \]
    \item 如果 \( Z \) 是 \( \mathbb{A}^n(k) \) 的子集且 \( \overline{Z} \)
      为其闭包, 那么
      \[
        V(I(Z)) = \overline{Z}.
      \]
  \end{enumerate}
\end{proposition}

\begin{corollary}
  映射
  \[
    \left\lbrace k[\mathbf{T}]\text{的根式理想}\mathfrak{a} \right\rbrace
    \xleftrightarrow[I(Z) \mapsfrom Z]{\mathfrak{a} \mapsto V(\mathfrak{a})}
    \left\lbrace \mathbb{A}^n(k) \text{的闭集} Z \right\rbrace
  \]
  互为逆映射. 特别地, 其限制定义了双射
  \[
    \left\lbrace k[\mathbf{T}] \text{的极大理想} \right\rbrace \leftrightarrow
    \left\lbrace \mathbb{A}^n(k) \text{中的点} \right\rbrace.
  \]
\end{corollary}

\subsection{Zariski 拓扑性质}

\paragraph{不可约性}

假设 \( X \) 是一个非空的拓扑空间. 如果 \( X \) 不能表示为两个真闭子空间的并,
那么称 \( X \) 是 \emph{不可约} 的. 对应地, \( X \) 的一个非空子集 \( Z \) 称为
\emph{不可约}, 如果其子空间拓扑不可约.

\begin{proposition}
  \label{proposition-irreducible-topology-equivalent-definition}
  假设 \( X \) 是一个非空拓扑空间. 那么下面断言等价
  \begin{enumerate}
    \item \( X \) 不可约;
    \item \( X \) 的任意两个非空开集有非空交;
    \item \( X \) 的任意非空开集稠密;
    \item \( X \) 的任意非空开集连通;
    \item \( X \) 的任意非空开集不可约.
  \end{enumerate}
\end{proposition}
\begin{proof}
  依定义可以直接验证 (i) 和 (ii), (ii) 和 (iii) 以及 (ii) 和 (iv) 是等价的.

  故只需证明 (iii) \( \implies \) (v). 如果 \( U \subseteq X \) 是一个非空开集,
  且 \( U = U_1 \cup U_2 \) 为其闭集分解. 那么存在 \( X \) 的闭集 \( V_i \) 使得
  \( U_i = V_i \cap U \), 其中 \( i = 1, 2 \). 注意到, \( V_1 \cup V_2 \supseteq
  U \) 为闭集, 而 \( X \) 不可约, 只能 \( V_1 \cup V_2 = X \). 因此 \( V_1 \) 或
  \( V_2 \) 为 \( X \) 本身, 这意味着 \( U_1 \) 或 \( U_2 \) 为 \( U \) 本身.
\end{proof}

\begin{corollary}
  假设 \( f: X \to Y \) 是一个拓扑空间的连续映射. 如果 \( Z \subseteq X \)
  是一个不可约子空间, 那么像 \( f(Z) \) 是不可约的.
\end{corollary}
\begin{proof}
  假设 \( V_1 \) 和 \( V_2 \) 是 \( f(Z) \) 的两个非空开集, 由
  \cref{proposition-irreducible-topology-equivalent-definition} 它们原像交非空,
  故它们交非空.
\end{proof}

\begin{lemma}
  \label{lemma-irreducible-iff-closure}
  令 \( X \) 是一个拓扑空间. 一个拓扑空间 \( Y \subseteq X \) 是不可约的当且仅当
  其闭包 \( \overline{Y} \) 是不可约的.
\end{lemma}
\begin{proof}
  \( \implies \) 如果 \( U_1, U_2 \) 为 \( \overline{Y} \) 的两个开集, 那么由
  \cref{proposition-irreducible-topology-equivalent-definition} \( (U_1 \cap Y)
  \cap (U_2 \cap Y) \neq \varnothing \). \( \impliedby \) 如果 \( V_1, V_2 \) 是
  \( Y \) 的两个开集, 那么存在 \( \overline{Y} \) 的两个开集 \( U_1, U_2 \) 使得
  \( U_i \cap Y = V_i \), 其中 \( i = 1, 2 \). 由
  \cref{proposition-irreducible-topology-equivalent-definition} \( U_1 \cap U_2
  \neq \varnothing \). 而由于 \( Y \) 在 \( \overline{Y} \) 中稠密, \( (U_1 \cap
  U_2) \cap Y \neq \varnothing \), 从而 \( V_1 \cap V_2 \neq \varnothing \).
\end{proof}

假设 \( U \subseteq X \) 是一个开集. 由 \cref{lemma-irreducible-iff-closure}, 有
\[
  \left\lbrace Y \subseteq U \text{ 不可约闭 } \right\rbrace \xleftrightarrow[Z
  \cap U \mapsfrom Z]{Y \mapsto \overline{Y}} \left\lbrace Z \subseteq X \text{
  不可约闭且 } Z \cap U \neq \varnothing \right\rbrace.
\]
\( X \) 的一个极大不可约子集称为 \( X \) 的一个 \emph{不可约分支}.

\begin{proposition}
  \label{proposition-irreducible-iff-prime}
  假设 \( Z \subseteq \mathbb{A}^n(k) \) 是一个闭集. 那么 \( Z \) 不可约当且仅当
  \( I(Z) \) 是一个素理想. 特别地, \( \mathbb{A}^n(k) \) 不可约.
\end{proposition}
\begin{proof}
  如果 \( fg \in I(Z) \), 那么 \( Z \subseteq V(fg) = V(f) \cup V(g) \). 如果
  \( Z \) 不可约, 那么 \( Z \subseteq V(f) \) 或 \( Z \subseteq V(g) \), 从而 \(
  f \in I(Z) \) 或 \( g \in I(Z) \).

  由 Zariski 拓扑的构造 \ref{proposition-Zariski-topology-construction} ,
  每个 \( \mathbb{A}^n(k) \) 的闭集都形如 \( V(f) \) 的交, 其中 \( f \in
  k[\mathbf{T}] \). 因此 \( Z \) 的闭集分解可以写为 \( Z = \bigcap_i V(f_i)
  \cup \bigcap_j V(g_j) \). 如果 \( Z \subseteq V(g_j) \) 对所有 \( j \) 成立,
  那么 \( Z \) 当然是不可约的; 否则, 存在一个 \( j_0 \) 使得 \( Z \not\subset
  V(g_{j_0}) \), 那么考察 \( Z \subseteq V(f_i) \cup V(g_{j_0}) = V(f_ig_{j_0})
  \), 可以知道 \( f_i g_{j_0} \in I(Z) \). 如果 \( I(Z) \) 是一个素理想,
  那么只能 \( f_i \in I(Z) \). 这是对所有 \( i \) 成立的.
\end{proof}

这里再给出一个引理, 方便后面使用(\cref{proposition-prevariaties-properties})
\begin{lemma}
  \label{lemma-irreducible-cover}
  假设 \( X \) 是一个拓扑空间且 \( X = \bigcup_{i \in I} U_i \) 是一个 \( X \)
  的开连通覆盖
  \begin{enumerate}
    \item 如果 \( X \) 不连通, 那么存在一个子集 \( \varnothing \neq J \subsetneq
      I \) 使得, 对每个 \( j \in J, i \in I \setminus J, U_j \cap U_i =
      \varnothing \).
    \item 如果 \( X \) 是连通的, \( I \) 是有限的并且所有 \( U_i \)
      都是不可约的, 那么 \( X \) 是不可约的.
  \end{enumerate}
\end{lemma}
\begin{proof}
  (i) 根据假设, 我们记 \( X = V_1 \cup V_2 \), 其中 \( V_1, V_2 \) 开. 那么每个
  \( U_i \) 要么包含在 \( V_1 \) 中要么包含在 \( V_2 \) 中, 进而能得到此论断.

  (ii) 如果 \( Z \subseteq X \) 是一个不可约分支且 \( Z \cap U_i \neq
  \varnothing \), 那么 \( Z \cap U_i \) 在 \( Z \) 中稠密. 因此 \( Z \cap
  \overline{U_i} = \overline{Z \cap U_i} = Z \). 由 \( Z \) 的极大性及 \(
  \overline{U_i} \) 的不可约性(\cref{lemma-irreducible-iff-closure}), 我们知道
  \( Z = \overline{U_i} \). 特别地, \( X \) 只有有限个不可约分支, 我们将其记作
  \( X_1, \ldots, X_n \). 如果 \( n > 1 \). 那么, 因为 \( X_i \) 闭, \( X \) 连通,
  \( X_1 \) 肯定交于某个 \( X_i \), 不妨设其是 \( X_2 \), 我们可以取 \( x \in
  X_1 \cap X_2 \). 设 \( i \in I \) 使得 \( x \in U_i \), 那么 \( U_i \cap X_1
  \) 在 \( X_1 \) 和 \( X_2 \) 中均开且稠密, 这说明 \( U_i \) 在 \( X \)
  中的闭包包含 \( X_1 \cup X_2 \) 且不可约, 这与 \( X_1 \) 和 \( X_2 \)
  的极大性矛盾.
\end{proof}

\paragraph{紧性}

一个拓扑空间 \( X \) 称为是 \emph{noetherian} 的, 如果每个闭集下降链
\[
  X \supseteq Z_1 \supseteq Z_2 \supseteq \cdots
\]
稳定.

\begin{lemma}
  如果 \( X \) 是一个由有限 noetherian 空间覆盖的 \( X = \bigcup_{i = 1}^r X_i
  \) 的拓扑空间, 那么 \( X \) 本身是 noetherian 的.
\end{lemma}

\begin{lemma}
  \label{lemma-noetherian-topology-properties}
  如果 \( X \) 是一个 noetherian 拓扑空间, 那么
  \begin{enumerate}
    \item 每个 \( X \) 的子空间都是 noetherian 的.
    \item 每个 \( X \) 的子集都是紧的.
    \item 每个 \( X \) 的子集 \( Z \) 都只有有限个不可约分支.
  \end{enumerate}
\end{lemma}
\begin{proof}
  (1) 是直接按定义的.

  对于 (2), 由 (1), 我们只需要知道 \( X \) 是紧的就足够了. 假设 \( X = \bigcup_i
  U_i \) 为开覆盖. 假设 \( \mathcal{U} \) 是\( U_i \) 有限并组成的集族. 因为 \(
  X \) noetherian, 所以 \( \mathcal{U} \) 有一个极大元素 \( V \). 如果 \( V \neq
  X \), 那么能找到 \( U \in \mathcal{U} \) 使得 \( V \subsetneq U \cup V \),
  这与极大性矛盾.

  对于 (3), 同样由 (1), 我们只需要知道 \( X \) 只有有限个不可约分支即可. 以 \(
  \mathcal{M} \) 记 \( X \) 中不能写成有限非空不可约集合并的闭集族, 那么存在一个
  \( \mathcal{M} \) 的极小元素 \( Z \). \( Z \) 并非不可约,
  故能写成两个它的真闭子集并, 而必有一个满足 \( \mathcal{M} \)
  定义中所描述的性质, 与 \( Z \) 的极小性矛盾.
\end{proof}

\begin{proposition}
  如果 \( X \subseteq \mathbb{A}^n(k) \) 是任意子空间, 那么 \( X \) noetherian.
\end{proposition}
\begin{proof}
  由 \cref{lemma-noetherian-topology-properties}, 只需要知道 \( X \) noetherian
  即可. \( \mathbb{A}^n(k) \) 的闭下降链对应了 \( k[\mathbf{T}] \) 根式理想升链.
  由 \href{https://en.wikipedia.org/wiki/Hilbert%27s_basis_theorem}{Hilbert
  基定理}, \( k[\mathbf{T}] \) noetherian, 从而升链有限.
\end{proof}

%TODO: 准素分解

\subsection{仿射代数集间的态射}

假设 \( X \subseteq \mathbb{A}^m(k) \) 和 \( Y \subseteq \mathbb{A}^n(k) \)
为仿射代数簇. 一个\emph{仿射态射簇的态射} \( f: X \to Y \) 指的是底集合为 \( X
\) 和 \( Y \) 的映射 \( f: X \to Y \) 满足存在多项式 \( f_1, \ldots, f_n \in
k[T_1, \ldots, T_m] \) 使得 \( f(x) = (f_1(x), \ldots, f_n(x)) \) 对每个 \( x
\in X \) 成立.

\begin{proposition}
  仿射代数簇间的态射是连续的.
\end{proposition}
\begin{proof}
  如果 \( f = (f_1, \ldots, f_n) \) 定义了映射 \( \mathbb{A}^m(k) \to
  \mathbb{A}^n(k) \), 其由多项式 \( f_i \in k[T_1, \ldots, T_m] \) 组成,
  那么我们得到了一个 \( k \)-代数同态 \( \Gamma(f): k[T'_1, \ldots, T'_n] \to
  k[T_1, \ldots, T_m] \) 将 \( T'_i \) 映到 \( f_i \).
  如果 \( V(\mathfrak{a}) \subseteq \mathbb{A}^n(k) \) 是一个闭集, 那么 \(
  f^{-1}(V(\mathfrak{a})) = V(\Gamma(f)(\mathfrak{a})) \) 闭.
  (\( x \in f^{-1}(V(\mathfrak{a})) \iff  g(f(x)) = (\Gamma(f) g)(x) = 0,
  \forall g \in \mathfrak{a} \iff x \in V(\Gamma(f)(\mathfrak{a})) \))
\end{proof}
\begin{proposition}
  仿射代数簇间的态射符合仍是仿射代数簇间的态射.
\end{proposition}
综上, 仿射代数簇构成了一个范畴.

\begin{remark}
  仿射代数簇范畴的缺点.
  \begin{enumerate}
    \item 仿射代数集的开集不再是仿射代数集.
    \item 尽管仿射代数集的交仍然是, 但是我们不能分辨 \( V(X) \cap V(Y) \subseteq
      \mathbb{A}^2(k) \) 与 \( V(Y) \cap V(X^2 - Y) \subseteq \mathbb{A}^2(k)
      \). %TODO: 什么鬼
    \item \( k \) 不是代数闭域时, 仿射代数集不能帮助研究多项式方程的解.
  \end{enumerate}
\end{remark}

\subsection{仿射坐标环}

假设 \( X \subseteq \mathbb{A}^n(k) \) 是一个闭空间. 集合 \( \operatorname{Hom}(X, \mathbb{A}^1(k) \) 自然具有 \( k
\)-代数结构:
\[
  (f + g)(x) = f(x) + g(x),\quad (fg) (x) = f(x) g(x).
\]
注意到, 每个多项式 \( f \in k[T_1, \ldots, T_n] \) 诱导了一个到仿射代数集的态射
\( X \to \mathbb{A}^1(k), x \mapsto f(x) \), 因此有 \( k \)-代数同态 \(
k[\mathbf{T}] \to \operatorname{Hom}(X, \mathbb{A}^1) \), 这时一个满态射,
我们记其核为 \( I(X) \). 我们称\( k \)-代数
\begin{equation}
  \Gamma(X) := k[T_1,\ldots, T_n] / I(X) \simeq \operatorname{Hom}(X,
  \mathbb{A}^1(X))
  \label{equation-affine-coordinate-ring}
\end{equation}
称为 \( X \) 的\emph{仿射坐标环}.

如果有 \( x = (x_1, \ldots, x_n) \in X \), 我们使用记 \( \mathfrak{m}_x \)
为理想
\[
  \mathfrak{m}_x = \left\lbrace f \in \Gamma(X): f(x) = 0 \right\rbrace
  \subseteq \Gamma(X)
\]
这是极大理想 \( (T_1 - x_1, \ldots, T_n - x_n) \) 在投影 \( \pi: k[\mathbf{T}]
\to \Gamma(X) \) 下的像. 或者换句话说, \( \mathfrak{m}_x \) 是赋值态射 \(
\Gamma(X) \to k, f \mapsto f(x) \) 的核, 进而 \( \Gamma(X) / \mathfrak{m}_x = k
\).

如果 \( \mathfrak{a} \subseteq \Gamma(X) \) 是一个理想, 考虑
\[
  V(\mathfrak{a}) = \left\lbrace x \in X: f(x) = 0, \forall f \in \mathfrak{a}
  \right\rbrace = V(\pi^{-1}(\mathfrak{a}))\cap X.
\]
因此, 将 \( X \) 赋予 \( \mathbb{A}^n(k) \) 的子空间拓扑, \( V(\mathfrak{a}) \)
就是 \( X \) 的闭子集. 我们同样称这是 Zariski 拓扑. 对于 \( f \in \Gamma(X) \),
我们记
\[
  D(f) := \left\lbrace x \in X: f(x) \neq 0 \right\rbrace = X \setminus V(f).
\]
形如这样的开集, 我们称为 \emph{主开集}.

\begin{lemma}
  主开集 \( D(f) \), \( f \in \Gamma(X) \), 形成了 \( X \) 的 Zariski
  拓扑的一组基. 有限主开集的交仍然是主开集.
\end{lemma}
\begin{proof}
  对于第二句话, 只需注意到 \( D(f) \cap D(g) = D(fg) \).
  记 \( X \) 中的开集 \( U \) 为 \( U = X \setminus V(\mathfrak{a}) \).
  \( \mathfrak{a} \) 是作为 noetherian 环的理想, 是有有限生成的, 故可以设 \(
  \mathfrak{a} = \left\langle f_1,\ldots, f_n \right\rangle \). 因此 \(
  V(\mathfrak{a}) = \bigcap_{i = 1}^n V(f_i) \), 也就是 \( U = \bigcup_{i = 1}^n
  D(f_i) \).
\end{proof}

\begin{proposition}
  \label{proposition-irreducible-iff-integral}
  假设 \( X \) 是一个仿射代数集. 仿射坐标环 \( \Gamma(X) \)
  是一个约化有限生成代数 \( k \)-代数. 此外, \( X \) 是不可约的当且仅当 \(
  \Gamma(X) \) 是一个整环.
\end{proposition}
\begin{proof}
  \( I(X) = \operatorname{rad}(I(X)) \) 告诉我们 \( \Gamma(X) \) 是约化的.
  最后一句话见 \cref{proposition-irreducible-iff-prime}.
\end{proof}

\subsection{仿射代数集与有限生成约化代数的范畴等价}

如果 \( f: X \to Y \) 是一个仿射代数集的态射, 那么映射
\[
  \Gamma(f): \operatorname{Hom}(Y, \mathbb{A}^1(k)) \to \operatorname{Hom}(X,
  \mathbb{A}^1 (k)),\quad g \mapsto g \circ f
\]
是一个 \( k \)-代数同态. 于是, 我们得到了一个函子

\[
  \Gamma: (\text{仿射代数集})^{\operatorname{opp}} \to
  (\text{约化有限生成代数}).
\]

\begin{proposition}
  \label{proposition-category-equivalence-irreducible-affine-and-finite-generated-algebra}
  实际上, 函子 \( \Gamma \) 是一个范畴等价. 特别地, 其限制亦是一个如下范畴等价:
  \[
    \Gamma: (\text{不可约仿射代数集})^{\operatorname{opp}} \to
    (\text{整有限生成代数})
  \]
\end{proposition}
\begin{proof}
  我们通过考虑定义逆映射证明 \( \Gamma \) 是一个全忠实函子.
  如果 \( \varphi: \Gamma(Y) \to \Gamma(X) \) 给定, 那么存在一个 \( k
  \)-代数同态 \( \widetilde{\varphi} \) 使得下图交换
  % https://q.uiver.app/#q=WzAsNCxbMCwwLCJrW1RfMScsIFxcbGRvdHMsIFQnX25dIl0sWzEsMCwia1tUXzEsXFxsZG90cyxUX21dIl0sWzAsMSwiXFxHYW1tYShZKSJdLFsxLDEsIlxcR2FtbWEoWCkiXSxbMCwyXSxbMCwxLCJcXHdpZGV0aWxkZXtcXHZhcnBoaX0iXSxbMiwzLCJcXHZhcnBoaSJdLFsxLDNdXQ==
  \[\begin{tikzcd}
    {k[T_1', \ldots, T'_n]} & {k[T_1,\ldots,T_m]} \\
    {\Gamma(Y)} & {\Gamma(X)}
    \arrow["{\widetilde{\varphi}}", from=1-1, to=1-2]
    \arrow[from=1-1, to=2-1]
    \arrow[from=1-2, to=2-2]
    \arrow["\varphi", from=2-1, to=2-2]
  \end{tikzcd}\]
  只需定义 \( f: X \to Y, x \mapsto (\widetilde{\varphi}(T'_1)(x),\ldots,
  \widetilde{\varphi}(T'_n)(x)) \).

  现在只需要证明函子是本质满的. 假设给定一个约化有限生成代数 \( A \), 那么 \( A
  \simeq k[T_1,\ldots, T_n]/ \mathfrak{a} \), 其中 \( \mathfrak{a} \subseteq
  k[\mathbf{T}] \) 是一个理想, 并且 \( \mathfrak{a} = \operatorname{rad}
  \mathfrak{a} \). 如果我们置 \( X = V(\mathfrak{a}) \subseteq \mathbb{A}^n(k)
  \), 那么 \( \Gamma(X) = k[T_1,\ldots, T_n] / \mathfrak{a} \).

  最后一个论断见 \cref{proposition-irreducible-iff-integral}.
\end{proof}

\begin{proposition}
  如果 \( f: X \to Y \) 是一个仿射代数集态射, \( \Gamma(f): \Gamma(Y) \to
  \Gamma(X) \) 是其对应的仿射坐标环同态, 那么 \( \Gamma(f)^{-1}(\mathfrak{m}_x)
  = \mathfrak{m}_{f(x)} \) 对所有 \( x \in X \).
\end{proposition}

\subsection{带函数空间的定义}

假设 \( K \) 为一个域.
\begin{enumerate}
  \item 一个 \emph{\( K \) 上带函数的空间} 是拓扑空间 \( X \) 带上一族 \( K
    \)-代数 \( \mathscr{O}_X \), 对每个 \( X \) 的开集 \( U \) 有 \(
    \mathscr{O}_X(U) \subseteq \operatorname{Map}(U, K) \) 满足下面性质
    \begin{itemize}
      \item 如果 \( U' \subseteq U \subseteq X \) 开且 \( f \in \mathscr{O}_X(U)
        \), 那么限制 \( \left. f \right\vert_{U'} \in \operatorname{Map}(U', K)
          \) 是 \( \mathscr{O}_X(U') \) 中的元素.
        \item (粘接公理) 给定开集 \( U_i \subseteq X, i \in I \), 以及 \( f_i
          \in \mathscr{O}_X(U_i), i \in I \). 如果
          \[
            \left. f_i \right\vert_{U_i \cap U_j} = \left. f_j \right\vert_{U_i
                \cap U_j},\quad \text{对所有} i, j \in I,
          \]
          那么唯一使得 \( \left. f \right\vert_{i} = f_i \) 对所有 \( i \in I \)
            成立的函数 \( f: \bigcup_i U_i \to K \) 落于 \(
            \mathscr{O}_X(\bigcup_i U_i) \) 中.
    \end{itemize}
  \item 带函数的空间态射 \( g: (X, \mathscr{O}_X) \to (Y, \mathscr{O}_Y) \)
    是\emph{连续的}, 指对所有开子集 \( V \subseteq Y \) 以及函数 \( f \in
    \mathcal{O}_Y(V) \), 函数 \( f \circ \left. g \right\vert_{g^{-1}(V)}:
      g^{-1}(V) \to K \) 落于 \( \mathscr{O}_X(g^{-1}(V)) \) 中.
\end{enumerate}

明显地, \( K \) 上带函数的空间构成了一个范畴.
此外, 假设 \( X \) 一个带函数的空间, \( U \subseteq X \) 为一个开空间. 我们记 \(
(U, \mathscr{O}_{X \mid U})\) 为带函数的空间 \( U \), 其中
\[
  \mathscr{O}_{X \mid U} (V) = \mathscr{O}_X(V) \quad V \subseteq U \text{ 开 }.
\]

\subsection{仿射代数集的带函数空间}

假设 \( X \subseteq \mathbb{A}^n(k) \) 是一个不可约仿射代数集, 并赋予其 Zariski
拓扑. 分式域
\[
  K(X) := \operatorname{Frac}(\Gamma(X))
\]
称为 \( X \) 的\emph{函数域}.

我们将 \( \Gamma(X) \) 视作态射集\eqref{equation-affine-coordinate-ring},
那么函数域中的元素形如 \( \frac{f}{g}, f, g \in \Gamma(X), g \neq 0 \).
因为分母可能有零点, 这通常不是一个 \( X \) 的函数, 但 \( \frac{f}{g} \)
定义了函数 \( D(g) \to \mathbb{A}^1(k) \). 因此,
我们能够使用这样的函数来定义带函数的空间.

\begin{lemma}
  \label{lemma-same-element-in-function-field}
  假设 \( X \) 是一个不可约仿射代数集, \( \frac{f_1}{g_1} \) 和 \(
  \frac{f_2}{g_2} \) 为 \( K(X) \) 的元素, 存在非空开集 \( U \subseteq
  D(g_1 g_2) \) 使得
  \[
    \frac{f_1(x)}{g_1(x)} = \frac{f_2(x)}{g_2(x)},\quad \forall x \in U.
  \]
  那么 \( \frac{f_1}{g_1} = \frac{f_2}{g_2} \in K(X) \).
\end{lemma}
\begin{proof}
  \( X \) 中闭集 \( V(f_1 g_2 - f_2 g_1) \) 包含稠密开集 \( U \), 因此它只能是
  \( X \) 本身. 而 \( \Gamma(X) \) 约化, 这意味着 \( f_1 g_2 - f_2 g_1 = 0 \).
\end{proof}

假设 \( X \) 是一个不可约仿射代数集, \( \varnothing \neq U \subseteq X \) 开.
我们记 \( \mathfrak{m}_x \) 为 \( \Gamma(X) \) 为对应 \( x \in X \) 的极大理想,
以及 \( \Gamma(X)_{\mathfrak{m}_x} \) 为仿射坐标环对 \( \mathfrak{m}_x \)
的局部化. 我们定义
\[
  \mathscr{O}_X(U) = \bigcap_{x \in U}\Gamma(X)_{\mathfrak{m}_x} \subseteq K(X).
\]
特别地, 我们令 \( \mathscr{O}_X(\varnothing) \) 为单点集.

这种情况下局部化 \( \Gamma(X)_{\mathfrak{m}_x} \) 可以表示为
\[
  \Gamma(X)_{\mathfrak{m}_x} = \bigcup_{f \in \Gamma(X) \setminus
  \mathfrak{m}_x} \Gamma(X)_f \subseteq K(X).
\]
考虑 \( (X, \mathscr{O}_X) \) 为带函数的空间, 我们首先来解释如何将 \(
\mathscr{O}_X \) 中的元素 \( f \) 视作函数 \( U \to k \). 给定 \( x \in U \),
那么 \( f \) 按定义于 \( \Gamma(X)_{\mathfrak{m}_x} \) 中, 因此我们可以将其写为
\( f = \frac{g}{h} \) 其中 \( g, h \in \Gamma(X), h \notin \mathfrak{m}_x \).
因此 \( h(x) \neq 0 \), 我们可以置 \( f(x) := \frac{g(x)}{h(x)} \in k \).
\cref{lemma-same-element-in-function-field} 告诉我们, \( f(x) \)
良定义且给出了单射 \( \mathscr{O}_X(U) \to \operatorname{Map}(U, k) \).
要证明 \( (X, \mathscr{O}_X) \) 是一个带函数的空间,
我们还需要证明其满足粘接公理. 这可以由 \( \mathscr{O}_X(U) \) 是函数域 \(
K(X) \) 子集自然得到. 我们称 \( (X, \mathscr{O}) \) 为 \emph{与 \( X \)
相关的带函数空间}.

在主开集 \( D(f) \) 上的函数有显式的表达.
\begin{proposition}
  \label{proposition-principal-open-space-with-functions}
  假设 \( (X, \mathscr{O}_X) \) 为与不可约仿射代数集 \( X \) 相关的带函数空间,
  且令 \( f \in \Gamma(X) \). 那么
  \[
    \mathscr{O}_X(D(f)) = \Gamma(X)_f.
  \]
  特别地, \( \mathscr{O}_X(X) = \Gamma(X) \).
\end{proposition}
\begin{proof}
  \( \Gamma(X)_f \subseteq \mathscr{O}_X(D(f)) \)  是明显的. 假设 \( g \in
  \mathscr{O}_X(D(f)) \) 并置
  \[
    \mathfrak{a} = \left\lbrace h \in \Gamma(X): hg \in \Gamma(X) \right\rbrace.
  \]
  显然 \( \mathfrak{a} \) 是 \( \Gamma(X) \) 的一个理想, 如果 \( f \in
  \operatorname{rad}(\mathfrak{a}) \), 那么 \( f^ng \in \Gamma(X) \) 对某个 \(
  n \) 成立, 换句话说 \( g \) 形如 \( h/f^n \) 其中 \( h \in \Gamma(X) \).
  我们现在来证明这个假设.

  因为 \( \operatorname{rad}(\mathfrak{a}) = I(V(\mathfrak{a})) \), 只需证明 \( f(x) = 0 \) 对所有 \( x \in
  V(\mathfrak{a}) \) 成立. 假设 \( x \in X \) 为一个点使得 \( f(x) \neq 0 \), 即
  \( x \in D(f) \). 因为 \( g \in \mathscr{O}_X(D(f)) \), 我们能够找到 \( g_1,
  g_2 \in \Gamma(X) \), \( g_2 \notin \mathfrak{m}_x \), 其中 \( g =
  \frac{g_1}{g_2} \). 因此 \( g_2 \in \mathfrak{a} \), 加上 \( g_2(x) \neq 0 \),
  我们有\( x \notin V(\mathfrak{a}) \).
\end{proof}

\begin{remark} %TODO: 补例子
  如果 \( X \) 是一个不可约仿射代数集, \( U \subseteq X \) 开, 并且 \( f \in
  \mathscr{O}_X(U) \), 那么\textbf{不一定}存在 \( g, h \in \Gamma(X) \) 使得 \(
  f = \frac{g}{h} \in K(X) \) 其中 \( h(x) \neq 0 \) 所有 \( x \in U \) 成立.
\end{remark}

\subsection{不可约仿射代数集到带函数空间的函子}

\begin{proposition}
  假设 \( X, Y \) 为两个不可约仿射代数集且 \( f: X \to Y \) 为一个映射.
  那么以下等价
  \begin{enumerate}
    \item 映射 \( f \) 是仿射代数集的态射.
    \item 如果 \( g \in \Gamma(Y) \), 那么 \( g \circ f \in \Gamma(X) \).
    \item 映射 \( f \) 是带函数空间的态射, 换句话说, \( f \) 是连续的而且如果 \(
      U \subseteq Y \) 开且 \( g \in \mathscr{O}_Y(U) \), 那么 \(
      \left. g \circ f \right\vert_{f^{-1}(U)} \in \mathscr{O}_X(f^{-1}(U)) \).
  \end{enumerate}
\end{proposition}
\begin{proof}
  (i) 和 (ii)
  的等价性见\cref{proposition-category-equivalence-irreducible-affine-and-finite-generated-algebra}.
  (iii) \( \implies \) (i) 只需令 \( U = Y \),
  并使用\cref{proposition-principal-open-space-with-functions}. 

  因此,我们只需证明 (ii) \( \implies \) (iii). 假设 \( \varphi: \Gamma(Y) \to
  \Gamma(X) \) 为同态 \( h \mapsto h \circ f \). 对于 \( g \in \Gamma(Y) \),
  我们有
  \[
    f^{-1}(D(g)) = \left\lbrace x \in X: g(f(x)) \neq 0 \right\rbrace =
    D(\varphi(g)).
  \]
  主开集是拓扑的一组基, 从而 \( f \) 是连续的. 同态 \( \varphi \)
  显然, \( \varphi \) 诱导了局部化的同态 \( \Gamma(Y)_g = \mathscr{O}_Y(D(g)) \to
  \Gamma(X)_{\varphi(g)} = \mathscr{O}_X(D(\varphi(g))), h \mapsto h \circ f \).
  从而, 我们证明了主开集的情形. 对于一般的情形, 利用粘接公理即可.
\end{proof}

\begin{theorem}
  构造 \( X \mapsto (X, \mathscr{O}_X) \) 定义了全忠实函子
  \[
    \left( \text{不可约仿射代数集} \right)  \to  \left( k \text{上的带函数空间}
    \right).
  \]
\end{theorem}

\subsection{预簇的定义}

我们称一个带函数空间 \( (X, \mathscr{O}) \) \emph{连通}, 如果其底拓扑空间 \( X
\) 是连通的.

\begin{enumerate}
  \item 一个 \emph{仿射簇} 是一个带函数空间,
    其同构于关于不可约仿射代数集的带函数空间.
  \item 一个 \emph{预簇} 是一个连通的带函数空间 \( (X, \mathscr{O}_X) \)
    其存在一个有限开覆盖 \( X = \bigcup_{i = 1}^n U_i \) 使得带函数空间 \( (U_i
    \mathscr{O}_{X \mid U_i}), \forall i = 1, \ldots, n \) 是一个仿射簇.
  \item 一个预簇的 \emph{态射} 是一个带函数空间的态射.
\end{enumerate}
特别地, 我们约定空拓扑空间不是连通的, 从而它\textbf{不是}预簇.

\begin{corollary}
  下面的范畴等价
  \begin{enumerate}
    \item 整有限生成 \( k \)-代数的反范畴.
    \item 不可约仿射代数集范畴.
    \item 仿射簇范畴.
  \end{enumerate}
\end{corollary}

我们定义预簇 \( X \) 的\emph{仿射开覆盖}为一组\( X \) 的带函数开子空间 \( U_i, i
\in I\) 并且 \( U_i \) 都是仿射簇使得 \( X = \bigcup_i U_i \).

\begin{proposition}
  \label{proposition-prevariaties-properties}
  如果 \( (X, \mathscr{O}_X) \) 为一个预簇, 那么拓扑空间是 noetherian 的, 还是
  不可约的.
\end{proposition}
\begin{proof}
  \cref{lemma-noetherian-topology-properties} 以及
  \cref{lemma-irreducible-cover}.
\end{proof}

%TODO: 对比微分几何

\subsection{开子预簇}

\begin{lemma}
  \label{lemma-principal-open-set-as-affine-subset}
  假设 \( X \) 是一个仿射簇, \( f \in \Gamma(X) = \mathscr{O}_X(X) \), \( D(f)
  \subseteq X \) 为一个对应的主开集. 令 \( \Gamma(X)_f \) 为 \( \Gamma(X) \) 在
  \( f \) 处的局部化, 且令 \( (Y, \mathscr{O}_Y) \) 为对应整有限生成 \( k
  \)-代数 \( \Gamma(X)_f \) 的仿射代数簇. 那么 \( (D(f), \mathscr{O}_{X \mid
  D(f)}) \) 和 \( (Y, \mathscr{O}_Y) \) 是同构的带函数空间. 特别地, \( (D(f),
  \mathscr{O}_{X \mid D(f)}) \) 是一个仿射代数簇.
\end{lemma}
\begin{proof}
  假设 \( X \subseteq \mathbb{A}^n(k) \) 以及 \( \mathfrak{a} = I(X) \subseteq
  k[T_1, \ldots, T_n] \) 为对应根式理想. 考虑 \( k[T_1, \ldots, T_n] \) 作为 \(
  k[T_1, \ldots, T_{n + 1}]\) 的子环, 以 \( \mathfrak{a}' \subseteq k[T_1,
  \ldots, T_{n+ 1}] \) 记作由 \( \mathfrak{a} \) 和 \( fT_{n + 1} - 1 \)
  生成的理想. 那么 \( Y \) 的仿射坐标环为 \( \Gamma(Y) = \Gamma(X)_f \simeq
  k[T_1, \ldots, T_{n + 1}] / \mathfrak{a}' \). 因此, 我们可以将 \( Y \) 视为 \(
  V(\mathfrak{a}') \subseteq \mathbb{A}^{n + 1}(k) \).

  设投影 \( \mathbb{A}^{n + 1}(k) \to \mathbb{A}^n(k) \) 为前 \( n \)
  个分量得到投影, 它诱导了双射
  \[
    j: Y = \left\lbrace (x, x_{n + 1}) \in X \times \mathbb{A}^1(k): x_{n +
    1}f(x) = 1 \right\rbrace \to D(f) = \left\lbrace x \in X: f(x) \neq 0
    \right\rbrace.
  \]
  下面, 我们证明 \( j \) 是带函数空间的同构. 作为连续映射的限制, \( j \) 连续.
  \( j \) 还是开映射, 如果 \( g / f^N \in \Gamma(Y) \), 那么 \( j(D(g / f^N)) =
  j(D(gf)) = D(gf) \). 因此 \( j \) 是个拓扑空间的同胚. 由粘接公理,
  现在只需要证明对所有 \( g \in \Gamma(X) \), 映射 \( \mathscr{O}(D(fg)) \to
  \Gamma(Y)_g, s \mapsto s \circ j \) 是一个同构, 这是显然的, 因为 \(
  \mathscr{O}_X(D(fg)) = \Gamma(X)_{fg} = \Gamma(Y)_g \).
\end{proof}

\begin{proposition}
  如果 \( (X, \mathscr{O}_X) \) 是一个预簇, \( U \subseteq X \) 是一个非空开集,
  那么 \( (U, \mathscr{O}_{X \mid U}) \) 是一个预簇并且包含映射 \( U \to X \)
  是一个预簇同态.
\end{proposition}
\begin{proof}
  由 \cref{proposition-prevariaties-properties}, \( X \) 不可约, \( U \)
  作为其非空开集, 自然亦是不可约的, 从而 \( U \) 是连通的. \( X \) noetherian,
  进而 \( U \) 亦是 noetherian 的, 从而 \( U \) 是紧的.
  \cref{lemma-principal-open-set-as-affine-subset} 告诉我们, \( U \) 能被 \( X
  \) 的开仿射子集覆盖, 从而能被有限个这样的子集覆盖.
\end{proof}

\subsection{预簇的函数域}

现在约定, \( X \) 是一个预簇. 如果 \( U, V\subseteq X \) 为非空仿射子簇, 那么 \(
U \cap V \) 在 \( U \) 中开且非空. 由函数域的定义, 我们有 \( \mathscr{O}_X(U)
\subseteq \mathscr{O}_X(U \cap V) \subseteq K(U) \). 因此, \(
\operatorname{Frac}(\mathscr{O}_X(U \cap V)) = K(U) \). 相同的讨论告诉我们, \(
K(V) = \operatorname{Frac}(\mathscr{O}_X(U \cap V)) = K(U) \). 因此, \( X \)
的非空开子簇 \( U \) 的函数域并不依赖于 \( U \) 的选取, 我们记其为 \( K(X) \),
并称 \( K(X) \) 为 \( X \) 的\emph{函数域}.

\begin{remark}
  一般来说, \( K(\cdot) \) 并不是仿射簇的函子, 因为仿射簇态射 \( f: X \to Y \)
  对应的同态 \( \Gamma(Y) \to \Gamma(X) \) 并不一定是单射.
\end{remark}

\begin{proposition}
  \label{proposition-prevariaty-local-and-global}
  假设 \( X \) 是一个预簇并且 \( U \subseteq X \) 是一个非空开集. 那么 \(
  \mathscr{O}_X(U) \) 是函数域 \( K(X) \) 一个 \( k \)-子代数. 如果 \( U'
  \subseteq U \) 是另一个非空子集, 那么限制映射 \( \mathscr{O}_X(U) \to
  \mathscr{O}_X(U') \) 是 \( K(X) \)-子代数的包含映射. 如果 \( U, V \subseteq X
  \) 是任意非空开子集, 那么 \( \mathscr{O}_X(U \cup V) = \mathscr{O}_X(U) \cap
  \mathscr{O}_X(V) \).
\end{proposition}
\begin{proof}
  如果 \( f: U \to \mathbb{A}^1(k) \) 为 \( \mathscr{O}_X(U) \) 的一个元素, 那么
  \( f \) 连续. 先假设 \( U \) 是一个仿射代数集(的主开集, 如果有必要). 由于 \(
  \mathbb{A}^1(k) \) 的闭集为有限集, 可以设为 \( \left\lbrace x_1, \ldots, x_n
  \right\rbrace \). \( f \in \mathscr{O}_X(U) \) 形如 \( g / h \), \( g / h =
  x_i \iff g - hx_i = 0 \) 其解有限, 而有限集在 \( U \) 中当然是闭集,
  从而可以知道 \( f \) 闭集逆仍是闭集. 对于一般的情形, 应用粘接引理即可.
  因此 \( f^{-1}(0) \subseteq U \) 是一个闭集.

  对于第二个论断, 结合 \( U' \) 稠密, 如果 \( f \) 限制到 \( U' \) 为零, \( f \)
  为零. 这告诉我们, 限制映射是单射.

  对于第一个论断, 取 \( U' \) 是 \( U \) 的仿射开子集即可.

  最后, 粘接公理告诉我们, \( \mathscr{O}_X(U \cup V) = \mathscr{O}_X(U) \cap
  \mathscr{O}_X(V) \).
\end{proof}

\subsection{闭子预簇}

假设 \( X \) 是一个预簇并令 \( Z \subseteq X \) 是一个不可约闭子集. 我们下面来给
\( Z \) 定义预簇结构. 首先, 给定 \( Z \) 的开集 \( U \), 我们定义:
\[
  \mathscr{O}_{Z}'(U) = \left\lbrace f \in \operatorname{Map}(U, k) \bigg\vert
    \begin{aligned}
    &\text{对所有} x \in U, \text{存在} x \in V \subseteq X \text{开}, g \in
      \mathscr{O}_{X}(V),\\ &\text{使得} \left. f \right\vert_{U \cap V} =
        \left. g \right\vert_{U \cap V}
    \end{aligned}
    \right\rbrace.
\]

\begin{lemma}
  假设 \( X \subseteq \mathbb{A}^n(k) \) 是一个不可约仿射代数簇, \( Z \subseteq
  X\) 是一个不可约闭子集. 那么关于仿射代数集 \( Z \) 的带函数空间 \( (Z,
  \mathscr{O}) \) 和上面定义的带函数空间 \( (Z, \mathscr{O}'_Z) \) 是一样的.
\end{lemma}
\begin{proof}
  两种情况下都赋予 \( Z \) 在 \( X \) 下的子空间拓扑. 作为包含映射 \( Z \to X \)
  是一个仿射代数集态射, 他诱导了带函数空间态射 \( (Z, \mathscr{O}_Z) \to (X,
  \mathscr{O}_X) \). \( \mathscr{O}_Z' \) 指出对所有开集 \( U \subseteq Z \),
  有 \( \mathscr{O}_Z'(U) \subseteq \mathscr{O}_Z(U) \).

  反过来, 如果 \( f \in \mathscr{O}_Z(U) \), 那么对每个 \( x \in U \), 都存在 \(
  h \in \Gamma(Z) \) 使得 \( x \in D(h) \subseteq U \). 限制\( \left.
    f \right\vert_{D(h)} \in \mathscr{O}_Z(U) = \Gamma(Z)_h \) 具有形式 \( f =
    \frac{g}{h^n}, n \geq 0, g \in \Gamma(Z) \). 我们将 \( g \) 和 \( h \)
    提升为 \( \widetilde{g}, \widetilde{h} \in \Gamma(X) \). 置 \( V :=
    D(\widetilde{h}) \subseteq X \), 那么 \( x \in V \), \(
    \frac{\widetilde{g}}{\widetilde{h}^n} \in \mathscr{O}_X(D(\widetilde{h})) \)
    以及 \( \left. f \right\vert_{U \cap V} =
      \left. \frac{\widetilde{g}}{\widetilde{h}^n} \right\vert_{U \cap V} \).
\end{proof}

\begin{proposition}
  假设 \( X \) 是一个预簇, \( Z \subseteq X \) 是一个不可约闭子集. 假设 \(
  \mathscr{O}_Z \) 按如上定义, 那么 \( (Z, \mathscr{O}_Z) \) 是一个预簇,
  包含映射 \( Z \hookrightarrow X \) 是预簇态射.
\end{proposition}

\subsection{齐次多项式}

假设 \( R \) 是一个给定的任意交换环. 一个多项式 \( f \in R[X_0, \ldots, X_n] \)
称为 \emph{\( d \in \mathbb{Z}_{\geq 0} \) 次齐次多项式}, 如果 \( f \) 是 \( d
\) 次单项式的和.

\begin{proposition}
  如果 \( R \) 是一个由无数个元素的整环, 那么一个多项式 \( f \in R[X_0, \ldots,
  X_n] \) 为 \( d \) 次齐次多项式当且多项式
  \[
    f(\lambda x_0, \ldots, \lambda x_n) = \lambda^d(x_0, \ldots, x_n),
  \]
  对所有 \( x_0, \ldots, x_n \in R \), \( 0 \neq \lambda \in R \) 成立.
\end{proposition}

我们可以将多项式环 \( R[X_0,\ldots, X_n] \) 分解为齐次多项式的直和
\[
  R[X_0, \ldots, X_n] = \bigoplus_{d \geq 0} R[X_0, \ldots, X_n]_d.
\]

\begin{lemma}
  假设 \( i \in \left\lbrace 0, \ldots, n \right\rbrace \) 以及 \( d \geq 0 \).
  那么存在 \( R \)-线性双射
  \begin{align*}
    \Phi_i = \Phi^{(d)}_i: R[X_0, \ldots, X_n]_d &\xrightarrow{\sim}
    \left\lbrace g \in R[T_0, \ldots, \widehat{T_i}, \ldots, T_n]: \deg (g) \leq
  d \right\rbrace,\\ f &\mapsto f(T_0, \ldots, 1, \ldots, T_n),
  \end{align*}
  其中 \( \widehat{\cdot} \) 是忽略此项的意思.
\end{lemma}
\begin{proof}
  假设 \( g \) 为右边的一个多项式, 将其分解为齐次项的和 \( g = \sum_{j = 0}^{d}
  g_j \), 考虑
  \[
    \Psi_i(g) = \sum_{j = 0}^{d}X_{i}^{d - j}g_j(X_0, \ldots, \widehat{X_i},
    \ldots, X_n).
  \]
  验证 \( \Phi_i \) 和 \( \Psi_i \) 互为逆映射即可.
\end{proof}
其中, 上面映射 \( \phi_i \) 称为 \emph{去齐次化}, \( \Psi \) 称为 \emph{齐次化}.
对 \( f \in R[X_0, \ldots, X_n]_d \) 以及 \( g \in R[X_0, \ldots, X_n]_e \)(\(
d, e \geq 0 \)), 容易知道乘积 \( fg \) 是 \( d + e \) 此齐次多项式, 我们有
\begin{equation}
  \Phi^{(d)}_i(f) \Phi^{(e)}_i(g) = \Phi^{(d + e)}_i (fg).
  \label{equation-dehomogenization}
\end{equation}
如果 \( R = K \) 是一个域, 我们可以将去齐次化和齐次化其扩张到分式域上去. 假设 \(
\mathcal{F} \) 是 \( K(X_0, \ldots, X_n) \) 由 \( \frac{f}{g} \) 组成的子集,
其中 \( f, g \in K[X_0, \ldots, X_n] \) 为相同次数的齐次多项式. 可以验证, \(
\mathcal{F} \) 是 \( K(X_0, \ldots, X_n) \) 的一个子域.
\eqref{equation-dehomogenization} 给出了下面 \( K \)-扩张同构
\begin{equation}
  \Phi_i \mathcal{F} \xrightarrow{\sim} K(T_0,\ldots, \widehat{T_i}, \ldots,
  T_n),\quad \frac{f}{g} \mapsto \frac{\Phi_i(f)}{\Phi_i(g)}.
  \label{equation-dehomogenization-isomorphism}
\end{equation}
我们经常将 \( K(T_0,\ldots, \widehat{T_i}, \ldots, T_n) \) 看作 \( K(K_0,
\ldots, K_n) \) 的子环 \( K \left( \frac{X_0}{X_i}, \ldots, \frac{X_n}{X_i}
\right) \). 在这种看法下, \eqref{equation-dehomogenization-isomorphism}
可以描述如下: 假设 \( \frac{f}{g} \in \mathcal{F} \) 其中 \( f, g \in K[X_0,
\ldots, X_n]_d \) 对某个 \( d \) 成立. 置 \( \widetilde{f} = \frac{f}{X_i^d} \)
以及 \( \widetilde{g} = \frac{g}{X_i^d} \), 那么 \( \widetilde{f}, \widetilde{g}
\in k \left[ \frac{X_0}{X_i}, \ldots, \frac{X_n}{X_i} \right] \) 以及 \(
\Phi_i\left(\frac{f}{g}\right) = \frac{\widetilde{f}}{\widetilde{g}} \).

\subsection{射影空间 \texorpdfstring{\( \mathbb{P}^n(k) \)}{Pn(k)} 的定义}

作为集合, 对每个域 \( k \) 我们定义
\[
  \mathbb{P}^n(k) = \left\lbrace k^{n + 1}\text{中过原点的直线} \right\rbrace =
  \left\lbrace k^{n + 1} \setminus \left\lbrace 0 \right\rbrace \right\rbrace /
  k^{\times},
\]
其中我们记 \( \left\lbrace k^{n + 1} \setminus \left\lbrace 0 \right\rbrace
\right\rbrace / k^{\times} \) 为 \( k^{n + 1} \setminus \left\lbrace 0
\right\rbrace \) 关于下面等价关系的等价类
\[
  (x_0, \ldots, x_n) \sim (x'_0, \ldots, x'_n) \iff \text{存在} \lambda \in
  k^{\times} \text{使得} x_i = \lambda x'_i.
\]
我们记等价类中的点 \( (x_0, \ldots, x_n) \) 为 \( (x_0: \ldots :x_n) \). 我们称
\( x_i \) 为 \( \mathbb{P}^n(k) \) 的 \emph{齐次坐标}.

现在假设 \( k \) 是一个代数闭集, 考察下面观察: 对 \( 0 \leq i \leq n \),
如果我们置
\[
  U_i := \left\lbrace (x_0: \ldots :x_n) \in \mathbb{P}^n(k): x_i \neq 0
  \right\rbrace \subseteq \mathbb{P}^n(k),
\]
那么 \( U_i, 0 \leq i \leq n \) 就是整个 \( \mathbb{P}^n(k) \). 存在双射
\[
  U_i \xrightarrow{\sim} \mathbb{A}^n(k),\quad (x_0: \ldots: x_n) \mapsto \left(
  \frac{x_0}{x_i}, \ldots, \widehat{\frac{x_i}{x_i}}, \ldots, \frac{x_n}{x_i}
\right).
\]
我们定义 \( \mathbb{P}^n(k) \) 的拓扑如下: 称 \( U \subseteq \mathbb{P}^n(k) \)
开, 如果对所有 \( i \), \( U \cap U_i \) 在 \( U_i \) 中开.
我们按如下定义开集 \( U \subseteq \mathbb{P}^n(k) \) 的函数
\[
  \mathscr{O}_{\mathbb{P}^n(k)}(U) = \left\lbrace f \in \operatorname{Map}(U,
  k): \text{对所有} i \in \left\lbrace 0, \ldots, n \right\rbrace, \text{有}
  \left. f \right\vert_{U \cap U_i} \in \mathcal{O}_{U_i}(U \cap U_i)
  \right\rbrace.
\]
\begin{proposition}
  假设 \( U \subseteq \mathbb{P}^n(k) \) 是开集, 那么
  \[
    \mathscr{O}_{\mathbb{P}^n(k)}(U) = \left\lbrace f: U \to k \Bigg\vert
      \begin{aligned}
      &\text{对所有} x \in U, \text{存在} x \in V \subseteq U \text{开, 以及} g,
      h \in k[X_0,\ldots, X_n]\\& \text{同次且齐次使得} h(v) \neq 0 \text{且}
      f(v) = \frac{g(v)}{h(v)} \text{对所有} v \in V \text{成立}
    \end{aligned} \right\rbrace.
  \]
\end{proposition}
\begin{proof}
  假设 \( f \in \mathscr{O}_{\mathbb{P}^n(k)}(U) \), 按定义 \( \left. f
    \right\vert_{U \cap U_i} \in \mathscr{O}_{U_i}(U \cap U_i) \), 函数 \( f \)
    局部上具有形式 \( \frac{\widetilde{g}}{\widetilde{h}} \) 其中 \(
    \widetilde{g}, \widetilde{h} \in k[T_0, \ldots, \widehat{T_i}, \ldots, T_n]
    \). \eqref{equation-dehomogenization-isomorphism} 给出了我们想要的形式.

  反过来, 假设 \( f \) 是右边的一个元素. 我们固定一个 \( i \in \left\lbrace 0,
  \ldots, n \right\rbrace \), 按假设局部上在 \( U \cap U_i \) 里面, 函数 \( f \)
  有形式 \( g/h \) 其中 \( g, h \in k[X_0,\ldots, X_n]_d \), \( d \) 为某个整数.
  再次应用 \eqref{equation-dehomogenization-isomorphism}, 我们知道 \( f \)
  局部上形如 \( \frac{\widetilde{g}}{\widetilde{h}} \), 其中 \( \widetilde{g},
  \widetilde{h} \in k[T_0, \ldots, \widehat{T_i}, \ldots, T_n] \). 这证明了 \(
  \left. f \right\vert_{U \cap U_i} \in \mathscr{O}_{U_i}(U \cap U_i) \).
\end{proof}

\begin{corollary}
  假设 \( i \in \left\lbrace 0, \ldots, n \right\rbrace \). 双射 \( U_i
  \xrightarrow{\sim} \mathbb{A}^n(k) \) 诱导了带函数空间的同构
  \[
    (U_i, \mathscr{O}_{\mathbb{P}^n(K) \mid U_i}) \xrightarrow{\sim}
    \mathbb{A}^n(k).
  \]
  带函数空间 \( (\mathbb{P}^n(k), \mathscr{O}_{\mathbb{P}^n(k)}) \) 是一个预簇.
\end{corollary}

利用同构 \( \Phi_i \) \eqref{equation-dehomogenization-isomorphism},
我们经常将函数域 \( K(\mathbb{P}^n(k)) \) 描述为域
\[
  K(\mathbb{P}^n(k)) = \left\lbrace \frac{f}{g}: f,g \in k{X_0, \ldots, X_n}
  \text{相同次数且齐次且} g\geq 0 \right\rbrace.
\]
对 \( 0 \leq i, j \leq n \), 同构 \( K(U_i) \xrightarrow{\sim} K(U_j) \) 由 \(
\Phi_j \circ \Phi_i^{-1} \) 给出, 它们可以显式写作
\begin{align*}
  K(U_i) = k \left( \frac{X_0}{X_i},\ldots,\frac{X_n}{X_i} \right) &\to k \left(
  \frac{X_0}{X_j}, \ldots, \frac{X_n}{X_j} \right) = K(U_j),\\
    \frac{X_l}{X_i} &\mapsto \frac{X_l / X_j}{X_i / X_j} = \frac{X_l}{X_i}.
\end{align*}
也就是说, \( K(X_0, \ldots, X_n) \) 的所有子域 \( K(U_i) \) 都是一样的,
从而它们和 \( K(\mathbb{P}^n(k)) \).

\begin{proposition}
  \( \mathbb{P}^n(k) \) 中的所有整体函数都是常数函数, 换句话说 \(
  \mathscr{O}_{\mathbb{P}^n(k)}(\mathbb{P}^n(k)) = k \). 特别地, 如果 \( n \geq
  1 \), \( \mathbb{P}^n(k) \) 不是仿射代数簇, 
\end{proposition}
\begin{proof}
  由 \cref{proposition-prevariaty-local-and-global} 有
  \[
    \mathscr{O}_{\mathbb{P}^n(k)} (\mathbb{P}^n(k)) = \bigcap_{0 \leq i \leq n}
    \mathscr{O}_{\mathbb{P}^n(k)} (U_i) = \bigcap_{0 \leq i \leq n} k
    \left[\frac{X_0}{X_i}, \ldots, \frac{X_n}{X_i}\right] = k,
  \]
  其中上面交取在 \( K(\mathbb{P}^n(k)) \) 中. 最后一句话成立是因为, 如果 \(
  \mathbb{P}^n(k) \) 仿射, 那么其点与环 \( k =
  \mathcal{O}_{\mathbb{P}^n(k)}(\mathbb{P}^n(k)) \) 的极大理想一一对应, 只能 \(
  n = 0 \).
\end{proof}

\subsection{射影簇}

一个预簇称为 \emph{射影簇} 如果其同构于射影空间 \( \mathbb{P}^n(k) \) 的闭预簇.

设齐次多项式 \( f_1, \ldots, f_m \in k[X_0, \ldots, X_n] \)(不必相同次数)
的消失集为
\[
  V_{+}(f_1, \ldots, f_m) = \left\lbrace (x_0: \ldots : x_n) \in \mathbb{P}^n(k)
  : f_j(x_0, \ldots, x_n) = 0, \forall j \right\rbrace.
\]
形如这样的子集是闭的, 因为对每个 \( i = 0,\ldots, n \)
\[
  V_{+}(f_1, \ldots, f_m) \cap U_i = V(\Phi_i(f_1), \ldots, \Phi_i(f_m))
\]
是闭集. 我们将会知道, 仿射空间的闭集都形如这样.

我们首先考虑映射
\[
  f: \mathbb{A}^{n + 1}(k) \setminus 0 \to \mathbb{P}^n(k),\quad (x_0, \ldots,
  x_n) \mapsto (x_0 : \cdots : x_n).
\]
对于每个 \( i \), 其限制 \( \left. f \right\vert_{f^{-1}(U_i)}: f^{-1}(U_i) \to
U_i \) 这是预簇的态射, 因此 \( f \) 亦是预簇的态射. 如果 \( Z \subseteq
\mathbb{P}^n(k) \) 是一个闭集, \( f^{-1}(Z) \) 是 \( \mathbb{A}^{n + 1}(k)
\setminus 0 \) 的一个闭集, 我们记 \( C(Z) \) 为它在 \( \mathbb{A}^{n + 1}(k)
\)的闭包.

仿射代数集 \( X \subseteq \mathbb{A}^{n + 1}(k) \) 称为\emph{仿射锥}, 如果对每个
\( x \in X \), 对所有 \( \lambda \in k^{\times} \), 我们都有 \( \lambda x \in X
\). \( C(Z) \) 是 \( \mathbb{A}^{n + 1}(k) \) 的一个仿射锥, 其称为 \( Z \)
的\emph{仿射锥}.

\begin{proposition}
  假设 \( X \subseteq \mathbb{A}^{n + 1}(k) \) 为一个仿射代数集使得 \( X \neq
  \left\lbrace 0 \right\rbrace \). 那么以下等价
  \begin{enumerate}
    \item \( X \) 是一个仿射锥.
    \item \( I(X) \) 由齐次多项式生成.
    \item 存在闭集 \( Z \subseteq \mathbb{P}^n(k) \) 使得 \( X = C(Z) \).
  \end{enumerate}
  如果 \( I(X) \) 由齐次多项式 \( f_1, \ldots, f_m \in k[X_0, \ldots, X_n] \)
  生成, 那么 \( Z = V_{+}(f_1, \ldots, f_m) \).
\end{proposition}
